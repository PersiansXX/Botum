<?php
// Hata ayıklama için PHP hata raporlamasını etkinleştir
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);

session_start();

// Giriş yapılmamışsa giriş sayfasına yönlendir
if (!isset($_SESSION['user_id'])) {
    header('Location: login.php');
    exit;
}

// Veritabanı bağlantısı
require_once 'includes/db_connect.php';

// Bot API'ye bağlan
require_once 'api/bot_api.php';
$bot_api = new BotAPI();

// Tab seçimi
$tab = isset($_GET['tab']) ? $_GET['tab'] : 'general';

// Güvenli tab seçimi
$allowed_tabs = ['general', 'timeframes', 'auto_discovery', 'indicators', 'indicator_signals', 
                'strategies', 'risk_management', 'risk_management_advanced', 
                'backtesting', 'smart_trend', 'adaptive_parameters', 
                'api_optimization', 'api_settings'];

if (!in_array($tab, $allowed_tabs)) {
    $tab = 'general';
}

// Mevcut ayarları al
$settings = $bot_api->getSettings();

// POST işlemi kontrolü
$message = '';
$message_type = '';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // Formdan gelen verileri doğrula ve güncelle
    try {
        $updated_settings = [
            'exchange' => $_POST['exchange'],
            'base_currency' => $_POST['base_currency'],
            'min_volume' => (float) $_POST['min_volume'],
            'max_coins' => (int) $_POST['max_coins'],
            'min_trade_amount' => (float) $_POST['min_trade_amount'],
            'max_trade_amount' => (float) $_POST['max_trade_amount'],
            'position_size' => (float) $_POST['position_size'],
            'api_delay' => (float) $_POST['api_delay'],
            'scan_interval' => (int) $_POST['scan_interval'],
            'use_tradingview' => isset($_POST['use_tradingview']),
            'tradingview_exchange' => $_POST['tradingview_exchange'],
            
            // Çoklu zaman aralığı ayarları
            'timeframes' => isset($_POST['timeframes']) ? $_POST['timeframes'] : ['1h'],
            'primary_timeframe' => $_POST['primary_timeframe'],
            'timeframe_weight_short' => (int) $_POST['timeframe_weight_short'],
            'timeframe_weight_medium' => (int) $_POST['timeframe_weight_medium'],
            'timeframe_weight_long' => (int) $_POST['timeframe_weight_long'],
            'timeframe_consensus' => $_POST['timeframe_consensus'],
            
            // Akıllı Trend Analizi ayarları
            'integration_settings' => [
                'use_smart_trend' => isset($_POST['use_smart_trend']),
                'smart_trend_settings' => [
                    'detection_method' => $_POST['trend_detection_method'],
                    'sensitivity' => (float) $_POST['trend_sensitivity'],
                    'lookback_period' => (int) $_POST['trend_lookback_period'],
                    'confirmation_period' => (int) $_POST['trend_confirmation_period'],
                    'signal_quality_threshold' => (float) $_POST['signal_quality_threshold']
                ]
            ],
              // Gelişmiş Risk Yönetimi ayarları
            'advanced_risk_management' => [
                'enabled' => isset($_POST['advanced_risk_enabled']),
                'dynamic_position_sizing' => isset($_POST['dynamic_position_sizing']),
                'position_size_method' => isset($_POST['position_size_method']) ? $_POST['position_size_method'] : (isset($settings['advanced_risk_management']['position_size_method']) ? $settings['advanced_risk_management']['position_size_method'] : 'fixed'),
                'max_risk_per_trade' => (float) $_POST['max_risk_per_trade'],
                'volatility_based_stops' => isset($_POST['volatility_based_stops']),
                'adaptive_take_profit' => isset($_POST['adaptive_take_profit']),
                'auto_adjust_risk' => isset($_POST['auto_adjust_risk']),
                'max_open_positions' => (int) $_POST['max_open_positions']
            ],
            
            // Adaptif Parametreler ayarları
            'adaptive_parameters' => [
                'enabled' => isset($_POST['adaptive_params_enabled']),
                'adaptation_speed' => (float) $_POST['adaptation_speed'],
                'market_regime_detection' => isset($_POST['market_regime_detection']),
                'volatility_adjustment' => isset($_POST['volatility_adjustment']),
                'trend_strength_adjustment' => isset($_POST['trend_strength_adjustment']),
                'reset_after_market_shift' => isset($_POST['reset_after_market_shift']),
                'learning_rate' => (float) $_POST['learning_rate'],
                'min_history_required' => (int) $_POST['min_history_required']
            ],
            
            // API Optimizasyonu ayarları
            'api_optimization' => [
                'enabled' => isset($_POST['api_optimization_enabled']),
                'api_call_limit_per_minute' => (int) $_POST['api_call_limit_per_minute'],
                'api_call_distribution' => $_POST['api_call_distribution'],
                'cache_duration' => (int) $_POST['cache_duration'],
                'prioritize_active_trades' => isset($_POST['prioritize_active_trades']),
                'reduce_timeframes_count' => isset($_POST['reduce_timeframes_count']),
                'optimize_indicator_calculations' => isset($_POST['optimize_indicator_calculations'])
            ],
            
            // Yeni eklenen otomatik coin keşfetme ayarları
            'auto_discovery' => [
                'enabled' => isset($_POST['auto_discovery_enabled']),
                'discovery_interval' => (int) $_POST['discovery_interval'],
                'min_volume_for_discovery' => (float) $_POST['min_volume_for_discovery'],
                'min_price_change' => (float) $_POST['min_price_change'],
                'min_volume_change' => (float) $_POST['min_volume_change'],
                'max_coins_to_discover' => (int) $_POST['max_coins_to_discover'],
                'auto_add_to_watchlist' => isset($_POST['auto_add_to_watchlist'])
            ],
            
            'indicators' => [
                'bollinger_bands' => [
                    'enabled' => isset($_POST['bb_enabled']),
                    'window' => (int) $_POST['bb_window'],
                    'num_std' => (float) $_POST['bb_num_std']
                ],
                'rsi' => [
                    'enabled' => isset($_POST['rsi_enabled']),
                    'window' => (int) $_POST['rsi_window']
                ],
                'macd' => [
                    'enabled' => isset($_POST['macd_enabled']),
                    'fast_period' => (int) $_POST['macd_fast'],
                    'slow_period' => (int) $_POST['macd_slow'],
                    'signal_period' => (int) $_POST['macd_signal']
                ],
                'moving_average' => [
                    'enabled' => isset($_POST['ma_enabled']),
                    'short_window' => (int) $_POST['ma_short'],
                    'long_window' => (int) $_POST['ma_long']
                ],
                'supertrend' => [
                    'enabled' => isset($_POST['supertrend_enabled']),
                    'period' => (int) $_POST['supertrend_period'],
                    'multiplier' => (float) $_POST['supertrend_multiplier']
                ],
                'vwap' => [
                    'enabled' => isset($_POST['vwap_enabled']),
                    'period' => isset($_POST['vwap_period']) ? (int) $_POST['vwap_period'] : 14
                ],
                'pivot_points' => [
                    'enabled' => isset($_POST['pivot_points_enabled']),
                    'method' => isset($_POST['pivot_points_method']) ? $_POST['pivot_points_method'] : 'standard'
                ],
                'fibonacci' => [
                    'enabled' => isset($_POST['fibonacci_enabled']),
                    'period' => isset($_POST['fibonacci_period']) ? (int) $_POST['fibonacci_period'] : 20
                ],
                'stochastic' => [
                    'enabled' => isset($_POST['stochastic_enabled']),
                    'k_period' => (int) $_POST['stochastic_k_period'],
                    'd_period' => (int) $_POST['stochastic_d_period'],
                    'slowing' => (int) $_POST['stochastic_slowing']
                ]
            ],
            'strategies' => [
                'short_term' => [
                    'enabled' => isset($_POST['short_term_enabled'])
                ],
                'trend_following' => [
                    'enabled' => isset($_POST['trend_following_enabled'])
                ],
                'breakout' => [
                    'enabled' => isset($_POST['breakout_enabled'])
                ],
                // Yeni volatilite kırılma stratejisi
                'volatility_breakout' => [
                    'enabled' => isset($_POST['volatility_breakout_enabled'])
                ]
            ],
            'risk_management' => [
                'enabled' => isset($_POST['risk_enabled']),
                'stop_loss' => (float) $_POST['stop_loss'],
                'take_profit' => (float) $_POST['take_profit'],
                'trailing_stop' => isset($_POST['trailing_stop']),
                'trailing_stop_distance' => (float) $_POST['trailing_stop_distance'],
                
                // Yeni eklenen trailing stop parametreleri
                'trailing_stop_activation_pct' => (float) $_POST['trailing_stop_activation_pct'],
                'trailing_stop_pct' => (float) $_POST['trailing_stop_pct'],
                
                'max_open_positions' => (int) $_POST['max_open_positions'],
                'max_risk_per_trade' => (float) $_POST['max_risk_per_trade']
            ],
            'backtesting' => [
                'default_start_date' => $_POST['default_start_date'],
                'default_end_date' => $_POST['default_end_date'],
                'initial_capital' => (float) $_POST['initial_capital'],
                'trading_fee' => (float) $_POST['trading_fee'],
                'slippage' => (float) $_POST['slippage'],
                'enable_visualization' => isset($_POST['enable_visualization'])
            ],
            // Yeni eklenen Telegram ayarları
            'telegram' => [
                'enabled' => isset($_POST['telegram_enabled']),
                'token' => $_POST['telegram_token'],
                'chat_id' => $_POST['telegram_chat_id'],
                'trade_signals' => isset($_POST['telegram_trade_signals']),
                'discovered_coins' => isset($_POST['telegram_discovered_coins'])
            ],
            // Yeni eklenen işlem modu ve ayarları
            'trade_mode' => $_POST['trade_mode'],
            'market_type' => $_POST['market_type'],
            'auto_trade' => isset($_POST['auto_trade']),
            'trade_direction' => $_POST['trade_direction'],
            // Yeni eklenen kaldıraç ayarları
            'leverage' => (int) $_POST['leverage'],
            'leverage_mode' => $_POST['leverage_mode'],
            // API anahtarları
            'api_keys' => [
                'binance_api_key' => $_POST['binance_api_key'],
                'binance_api_secret' => $_POST['binance_api_secret'],
                'kucoin_api_key' => $_POST['kucoin_api_key'],
                'kucoin_api_secret' => $_POST['kucoin_api_secret'],
                'kucoin_api_passphrase' => $_POST['kucoin_api_passphrase']
            ],
            // İndikatör sinyalleri ve ağırlıkları için yeni eklenen ayarlar
            'indicator_weights' => [
                'rsi' => (int) $_POST['rsi_weight'],
                'macd' => (int) $_POST['macd_weight'],
                'bollinger_bands' => (int) $_POST['bollinger_weight'],
                'moving_average' => (int) $_POST['ma_weight'],
                'supertrend' => (int) $_POST['supertrend_weight'],
                'stochastic' => (int) $_POST['stochastic_weight'],
                'adx' => (int) $_POST['adx_weight'],
                'other' => (int) $_POST['other_weight']
            ],
            'signal_consensus_method' => $_POST['signal_consensus_method'],
            'signal_consensus_threshold' => (int) $_POST['signal_consensus_threshold'],
            'signal_confirmation_count' => (int) $_POST['signal_confirmation_count'],
            'signal_conflicting_action' => $_POST['signal_conflicting_action'],
            'indicator_signals' => [
                'rsi' => [
                    'oversold' => (int) $_POST['rsi_oversold'],
                    'overbought' => (int) $_POST['rsi_overbought'],
                    'center_line_cross' => isset($_POST['rsi_center_line_cross']),
                    'divergence' => isset($_POST['rsi_divergence'])
                ],
                'bollinger_bands' => [
                    'squeeze_threshold' => (float) $_POST['bb_squeeze_threshold'],
                    'breakout_confirmation_candles' => (int) $_POST['bb_breakout_confirmation_candles'],
                    'use_percentage_b' => isset($_POST['bb_percentage_b']),
                    'mean_reversion' => isset($_POST['bb_mean_reversion'])
                ],
                'macd' => [
                    'signal_strength' => (float) $_POST['macd_signal_strength'],
                    'zero_line_cross' => isset($_POST['macd_zero_line_cross']),
                    'histogram_divergence' => isset($_POST['macd_histogram_divergence']),
                    'trigger_type' => $_POST['macd_trigger_type']
                ],                'supertrend' => [
                    'confirmation_candles' => (int) $_POST['supertrend_confirmation_candles'],
                    'filter_adx' => isset($_POST['supertrend_filter_adx']),
                    'adx_threshold' => isset($_POST['supertrend_adx_threshold']) ? (int) $_POST['supertrend_adx_threshold'] : (isset($settings['indicator_signals']['supertrend']['adx_threshold']) ? $settings['indicator_signals']['supertrend']['adx_threshold'] : 25)
                ]
            ]
        ];
        
        // Ayarları güncelle
        if ($bot_api->updateSettings($updated_settings)) {
            $message = 'Ayarlar başarıyla güncellendi!';
            $message_type = 'success';
            $settings = $bot_api->getSettings(); // Yeniden yükle
        } else {
            $message = 'Ayarlar güncellenirken bir hata oluştu!';
            $message_type = 'danger';
        }
    } catch (Exception $e) {
        $message = 'Hata: ' . $e->getMessage();
        $message_type = 'danger';
    }
}

// Sayfa başlığı
$page_title = 'Bot Ayarları';
?>

<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?php echo $page_title; ?></title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    
    <!-- jQuery ve Boostrap JS dosyaları (önce jQuery, sonra Popper.js, ardından Bootstrap) -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    
    <style>
        /* Ayarlar sayfası için özel stiller */
        .settings-wrapper {
            padding: 0.5rem;
        }
        
        .settings-card {
            border-radius: 0.75rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            overflow: hidden;
            border: none;
        }
        
        .settings-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 1.25rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .settings-header h5 {
            margin: 0;
            font-weight: 600;
            font-size: 1.25rem;
        }

        .settings-header i {
            margin-right: 0.75rem;
            font-size: 1.1rem;
        }

        .nav-tabs {
            background-color: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            padding: 0 1rem;
        }
        
        .nav-tabs .nav-link {
            border: none;
            border-bottom: 3px solid transparent;
            color: var(--secondary);
            font-weight: 500;
            padding: 1rem 1.25rem;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-tabs .nav-link:hover {
            color: var(--primary);
            border-bottom-color: rgba(58, 109, 240, 0.3);
            background-color: transparent;
        }
        
        .nav-tabs .nav-link.active {
            color: var(--primary);
            background-color: transparent;
            border-bottom-color: var(--primary);
            font-weight: 600;
        }

        .nav-tabs .nav-link i {
            margin-right: 0.5rem;
        }

        .tab-content {
            padding: 1.5rem;
        }
        
        .settings-panel {
            background-color: white;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .settings-panel:hover {
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }
        
        .settings-panel h5 {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-text);
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
        }
        
        .settings-panel h5 i {
            margin-right: 0.75rem;
            color: var(--primary);
        }
        
        .settings-footer {
            background-color: #f9fafb;
            border-top: 1px solid #e5e7eb;
            padding: 1.25rem;
            text-align: center;
        }
        
        /* Form kontrolleri için stiller */
        .settings-form label {
            font-weight: 500;
            color: var(--secondary);
        }
        
        .settings-form .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.2rem rgba(58, 109, 240, 0.25);
        }
        
        .settings-form .custom-switch .custom-control-label::before {
            border-radius: 1rem;
            height: 1.25rem;
            width: 2.25rem;
        }
        
        .settings-form .custom-switch .custom-control-label::after {
            height: calc(1.25rem - 4px);
            width: calc(1.25rem - 4px);
        }
        
        .settings-form .custom-control-input:checked ~ .custom-control-label::before {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        /* İndikatör ve strateji kartları için stiller */
        .feature-card {
            border-radius: 0.5rem;
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s ease;
            margin-bottom: 1.5rem;
        }
        
        .feature-card:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .feature-card-header {
            background-color: rgba(0, 0, 0, 0.03);
            padding: 0.85rem 1.25rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .feature-card-header h5 {
            margin: 0;
            font-size: 1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }
        
        .feature-card-header h5 i {
            margin-right: 0.75rem;
            color: var(--primary);
            font-size: 1.1rem;
        }
        
        .feature-card-body {
            padding: 1.25rem;
        }
        
        .feature-card.enabled {
            border-left: 3px solid var(--primary);
        }
        
        .feature-card.disabled {
            opacity: 0.75;
        }
        
        /* Açıklayıcı metin ve ipuçları için stiller */
        .feature-description {
            font-size: 0.9rem;
            color: var(--secondary);
            margin-top: 0.5rem;
        }
        
        .tooltip-icon {
            color: var(--secondary);
            margin-left: 0.5rem;
            font-size: 0.85rem;
            cursor: pointer;
        }
        
        /* Form alanları gruplandırma stili */
        .form-group-container {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1.25rem;
            margin-bottom: 1.5rem;
            background-color: rgba(0, 0, 0, 0.01);
        }
        
        .form-group-title {
            font-size: 1rem;
            font-weight: 500;
            margin-bottom: 1rem;
            color: var(--secondary);
            display: flex;
            align-items: center;
        }
        
        .form-group-title i {
            margin-right: 0.5rem;
            color: var(--primary);
        }

        /* Dosya içindeki diğer özel stilleri koru */
        .card-header.bg-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light)) !important;
        }

        .alert-success {
            border-left: 4px solid #10b981;
        }

        .alert-danger {
            border-left: 4px solid #ef4444;
        }

        /* Save buton stili */
        .btn-save {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 2.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(58, 109, 240, 0.3);
        }
        
        .btn-save:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(58, 109, 240, 0.4);
        }

        .btn-save i {
            margin-right: 0.5rem;
        }

        /* Açıklayıcı kutucuklar */
        .info-box {
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            display: flex;
            align-items: flex-start;
            transition: all 0.3s ease;
        }

        .info-box i {
            margin-right: 1rem;
            font-size: 1.5rem;
        }

        .info-box.info {
            background-color: rgba(59, 130, 246, 0.1);
            border-left: 4px solid var(--info);
        }

        .info-box.warning {
            background-color: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
        }

        .info-box.tip {
            background-color: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--success);
        }
    </style>
    <!-- jQuery ve Bootstrap JS dosyalarını sayfanın başına taşıyorum -->
</head>
<body>
    <?php include 'includes/navbar.php'; ?>
    
    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Sol Menü -->
            <div class="col-md-2">
                <?php include 'includes/sidebar.php'; ?>
            </div>
            
            <!-- Ana İçerik -->
            <div class="col-md-10 settings-wrapper">
                <div class="settings-card">
                    <div class="settings-header">
                        <h5><i class="fas fa-cogs"></i> Bot Ayarları</h5>
                    </div>
                    <div class="card-body p-0">
                        <?php if($message): ?>
                        <div class="alert alert-<?php echo $message_type; ?> m-3">
                            <?php echo $message; ?>
                        </div>
                        <?php endif; ?>
                        
                        <form method="post" action="" class="settings-form">
                            <ul class="nav nav-tabs" id="settingsTabs" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="general-tab" data-toggle="tab" href="#general" role="tab" aria-controls="general" aria-selected="true">
                                        <i class="fas fa-cogs"></i> Genel Ayarlar
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="timeframes-tab" data-toggle="tab" href="#timeframes" role="tab" aria-controls="timeframes" aria-selected="false">
                                        <i class="fas fa-clock"></i> Zaman Aralıkları
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="auto-discovery-tab" data-toggle="tab" href="#auto-discovery" role="tab" aria-controls="auto-discovery" aria-selected="false">
                                        <i class="fas fa-search-dollar"></i> Otomatik Keşif
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="indicators-tab" data-toggle="tab" href="#indicators" role="tab" aria-controls="indicators" aria-selected="false">
                                        <i class="fas fa-chart-line"></i> İndikatörler
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="indicator-signals-tab" data-toggle="tab" href="#indicator-signals" role="tab" aria-controls="indicator-signals" aria-selected="false">
                                        <i class="fas fa-signal"></i> İndikatör Sinyalleri
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="strategies-tab" data-toggle="tab" href="#strategies" role="tab" aria-controls="strategies" aria-selected="false">
                                        <i class="fas fa-chess"></i> Stratejiler
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="risk-management-tab" data-toggle="tab" href="#risk-management" role="tab" aria-controls="risk-management" aria-selected="false">
                                        <i class="fas fa-shield-alt"></i> Risk Yönetimi
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="risk-management-advanced-tab" data-toggle="tab" href="#risk-management-advanced" role="tab" aria-controls="risk-management-advanced" aria-selected="false">
                                        <i class="fas fa-user-shield"></i> Gelişmiş Risk
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="backtesting-tab" data-toggle="tab" href="#backtesting" role="tab" aria-controls="backtesting" aria-selected="false">
                                        <i class="fas fa-vial"></i> Backtesting
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="smart-trend-tab" data-toggle="tab" href="#smart-trend" role="tab" aria-controls="smart-trend" aria-selected="false">
                                        <i class="fas fa-chart-line"></i> Akıllı Trend
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="adaptive-parameters-tab" data-toggle="tab" href="#adaptive-parameters" role="tab" aria-controls="adaptive-parameters" aria-selected="false">
                                        <i class="fas fa-sliders-h"></i> Adaptif Parametreler
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="api-optimization-tab" data-toggle="tab" href="#api-optimization" role="tab" aria-controls="api-optimization" aria-selected="false">
                                        <i class="fas fa-tachometer-alt"></i> API Optimizasyonu
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="api-tab" data-toggle="tab" href="#api" role="tab" aria-controls="api" aria-selected="false">
                                        <i class="fas fa-key"></i> API Ayarları
                                    </a>
                                </li>
                            </ul>
                            
                            <div class="tab-content" id="settingsTabContent">
                                <!-- Genel Ayarlar -->
                                <div class="tab-pane fade show active" id="general" role="tabpanel">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="exchange">Borsa</label>
                                                <select name="exchange" id="exchange" class="form-control">
                                                    <option value="binance" <?php echo $settings['exchange'] == 'binance' ? 'selected' : ''; ?>>Binance</option>
                                                    <option value="kucoin" <?php echo $settings['exchange'] == 'kucoin' ? 'selected' : ''; ?>>KuCoin</option>
                                                    <option value="ftx" <?php echo $settings['exchange'] == 'ftx' ? 'selected' : ''; ?>>FTX</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="base_currency">Baz Para Birimi</label>
                                                <select name="base_currency" id="base_currency" class="form-control">
                                                    <option value="USDT" <?php echo $settings['base_currency'] == 'USDT' ? 'selected' : ''; ?>>USDT</option>
                                                    <option value="BTC" <?php echo $settings['base_currency'] == 'BTC' ? 'selected' : ''; ?>>BTC</option>
                                                    <option value="ETH" <?php echo $settings['base_currency'] == 'ETH' ? 'selected' : ''; ?>>ETH</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="min_volume">Minimum Hacim</label>
                                                <input type="number" step="0.01" name="min_volume" id="min_volume" class="form-control" 
                                                       value="<?php echo $settings['min_volume']; ?>">
                                                <small class="form-text text-muted">Coin seçimi için minimum günlük işlem hacmi</small>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="max_coins">Maksimum Coin Sayısı</label>
                                                <input type="number" name="max_coins" id="max_coins" class="form-control" 
                                                       value="<?php echo $settings['max_coins']; ?>">
                                                <small class="form-text text-muted">Aynı anda takip edilecek maksimum coin sayısı</small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="min_trade_amount">Minimum İşlem Tutarı</label>
                                                <div class="input-group">
                                                    <input type="number" step="0.01" name="min_trade_amount" id="min_trade_amount" class="form-control" 
                                                           value="<?php echo $settings['min_trade_amount']; ?>">
                                                    <div class="input-group-append">
                                                        <span class="input-group-text"><?php echo $settings['base_currency']; ?></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="max_trade_amount">Maksimum İşlem Tutarı</label>
                                                <div class="input-group">
                                                    <input type="number" step="0.01" name="max_trade_amount" id="max_trade_amount" class="form-control" 
                                                           value="<?php echo $settings['max_trade_amount']; ?>">
                                                    <div class="input-group-append">
                                                        <span class="input-group-text"><?php echo $settings['base_currency']; ?></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="form-group">
                                                <label for="position_size">Pozisyon Büyüklüğü</label>
                                                <div class="input-group">
                                                    <input type="number" step="0.01" name="position_size" id="position_size" class="form-control" 
                                                           value="<?php echo $settings['position_size']; ?>" min="0.01" max="1">
                                                    <div class="input-group-append">
                                                        <span class="input-group-text">%</span>
                                                    </div>
                                                </div>
                                                <small class="form-text text-muted">Bakiyenin yüzde kaçını kullanacağı (0.01-1)</small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="api_delay">API Gecikme Süresi</label>
                                                <div class="input-group">
                                                    <input type="number" step="0.1" name="api_delay" id="api_delay" class="form-control" 
                                                           value="<?php echo $settings['api_delay']; ?>">
                                                    <div class="input-group-append">
                                                        <span class="input-group-text">saniye</span>
                                                    </div>
                                                </div>
                                                <small class="form-text text-muted">API istekleri arasındaki bekleme süresi</small>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="scan_interval">Tarama Aralığı</label>
                                                <div class="input-group">
                                                    <input type="number" name="scan_interval" id="scan_interval" class="form-control" 
                                                           value="<?php echo $settings['scan_interval']; ?>">
                                                    <div class="input-group-append">
                                                        <span class="input-group-text">saniye</span>
                                                    </div>
                                                </div>
                                                <small class="form-text text-muted">Tüm coinleri tarama aralığı</small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label>TradingView Entegrasyonu</label>
                                                <div class="custom-control custom-switch">
                                                    <input type="checkbox" class="custom-control-input" id="use_tradingview" name="use_tradingview" 
                                                           <?php echo isset($settings['use_tradingview']) && $settings['use_tradingview'] ? 'checked' : ''; ?>>
                                                    <label class="custom-control-label" for="use_tradingview">TradingView kullan</label>
                                                </div>
                                                <small class="form-text text-muted">CCXT yerine TradingView API kullanarak veri çek</small>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label for="tradingview_exchange">TradingView Borsa Öneki</label>
                                                <select name="tradingview_exchange" id="tradingview_exchange" class="form-control">
                                                    <option value="BINANCE" <?php echo isset($settings['tradingview_exchange']) && $settings['tradingview_exchange'] == 'BINANCE' ? 'selected' : ''; ?>>Binance</option>
                                                    <option value="KUCOIN" <?php echo isset($settings['tradingview_exchange']) && $settings['tradingview_exchange'] == 'KUCOIN' ? 'selected' : ''; ?>>KuCoin</option>
                                                    <option value="COINBASE" <?php echo isset($settings['tradingview_exchange']) && $settings['tradingview_exchange'] == 'COINBASE' ? 'selected' : ''; ?>>Coinbase</option>
                                                </select>
                                                <small class="form-text text-muted">TradingView'da kullanılacak borsa öneki</small>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- İşlem Modu ve Yönü Ayarları -->
                                    <div class="row mt-3">
                                        <div class="col-12">
                                            <h5 class="font-weight-bold mb-3"><i class="fas fa-exchange-alt"></i> İşlem Ayarları</h5>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="trade_mode">
                                                    İşlem Modu
                                                    <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Botun gerçek/sanal işlem yapma modu"></i>
                                                </label>
                                                <select name="trade_mode" id="trade_mode" class="form-control">
                                                    <option value="paper" <?php echo (!isset($settings['trade_mode']) || $settings['trade_mode'] == 'paper') ? 'selected' : ''; ?>>Kağıt Üzerinde (Paper)</option>
                                                    <option value="live" <?php echo isset($settings['trade_mode']) && $settings['trade_mode'] == 'live' ? 'selected' : ''; ?>>Gerçek (Live)</option>
                                                </select>
                                                <small class="form-text text-muted">Paper: simülasyon, Live: gerçek para ile işlem</small>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="market_type">
                                                    Piyasa Türü
                                                    <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="İşlemlerin hangi piyasada yapılacağı"></i>
                                                </label>
                                                <select name="market_type" id="market_type" class="form-control">
                                                    <option value="spot" <?php echo (!isset($settings['market_type']) || $settings['market_type'] == 'spot') ? 'selected' : ''; ?>>Spot</option>
                                                    <option value="margin" <?php echo isset($settings['market_type']) && $settings['market_type'] == 'margin' ? 'selected' : ''; ?>>Marjin</option>
                                                    <option value="futures" <?php echo isset($settings['market_type']) && $settings['market_type'] == 'futures' ? 'selected' : ''; ?>>Vadeli</option>
                                                </select>
                                                <small class="form-text text-muted">İşlemlerin yapılacağı piyasa türü</small>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="trade_direction">
                                                    İşlem Yönü
                                                    <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Botun hangi yönde işlem yapacağı"></i>
                                                </label>
                                                <select name="trade_direction" id="trade_direction" class="form-control">
                                                    <option value="both" <?php echo (!isset($settings['trade_direction']) || $settings['trade_direction'] == 'both') ? 'selected' : ''; ?>>Her İki Yön</option>
                                                    <option value="long" <?php echo isset($settings['trade_direction']) && $settings['trade_direction'] == 'long' ? 'selected' : ''; ?>>Sadece Long</option>
                                                    <option value="short" <?php echo isset($settings['trade_direction']) && $settings['trade_direction'] == 'short' ? 'selected' : ''; ?>>Sadece Short</option>
                                                </select>
                                                <small class="form-text text-muted">Botun hangi yönde işlem yapacağını belirler</small>
                                            </div>
                                        </div>
                                        
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label>
                                                    Otomatik İşlem
                                                    <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Bot otomatik olarak alım-satım yapabilir"></i>
                                                </label>
                                                <div class="custom-control custom-switch mt-2">
                                                    <input type="checkbox" class="custom-control-input" id="auto_trade" name="auto_trade"
                                                           <?php echo isset($settings['auto_trade']) && $settings['auto_trade'] ? 'checked' : ''; ?>>
                                                    <label class="custom-control-label" for="auto_trade">Otomatik İşlem</label>
                                                </div>
                                                <small class="form-text text-muted">Bot, sinyallere göre otomatik işlem açıp kapatır</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Zaman Aralıkları -->
                                <div class="tab-pane fade" id="timeframes" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Çoklu Zaman Aralıkları</h6>
                                            <p class="mb-0">Botun analiz edeceği birden fazla zaman aralığını seçebilirsiniz. Bot, seçilen tüm zaman aralıklarında analiz yaparak en güvenilir sinyalleri üretecektir.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-clock"></i> Kullanılacak Zaman Aralıkları</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-12 mb-3">
                                                    <div class="alert alert-info">
                                                        <i class="fas fa-lightbulb"></i> Bot, seçtiğiniz tüm zaman aralıklarında analiz yapacak ve coinin durumuna göre en güvenilir zaman diliminde en doğru kararı verecektir.
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mb-4">
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_1m" name="timeframes[]" value="1m" 
                                                               <?php echo isset($settings['timeframes']) && in_array('1m', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_1m">1 Dakika</label>
                                                        <small class="form-text text-muted">Çok kısa vadeli, hızlı alım-satım için</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_3m" name="timeframes[]" value="3m" 
                                                               <?php echo isset($settings['timeframes']) && in_array('3m', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_3m">3 Dakika</label>
                                                        <small class="form-text text-muted">Kısa vadeli işlemler için</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_5m" name="timeframes[]" value="5m" 
                                                               <?php echo isset($settings['timeframes']) && in_array('5m', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_5m">5 Dakika</label>
                                                        <small class="form-text text-muted">Scalping stratejileri için ideal</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_15m" name="timeframes[]" value="15m" 
                                                               <?php echo isset($settings['timeframes']) && in_array('15m', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_15m">15 Dakika</label>
                                                        <small class="form-text text-muted">Kısa-orta vadeli işlemler için</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mb-4">
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_30m" name="timeframes[]" value="30m" 
                                                               <?php echo isset($settings['timeframes']) && in_array('30m', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_30m">30 Dakika</label>
                                                        <small class="form-text text-muted">Orta vadeli işlemler için</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_1h" name="timeframes[]" value="1h" 
                                                               <?php echo !isset($settings['timeframes']) || in_array('1h', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_1h">1 Saat</label>
                                                        <small class="form-text text-muted">En yaygın kullanılan zaman dilimi</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_2h" name="timeframes[]" value="2h" 
                                                               <?php echo isset($settings['timeframes']) && in_array('2h', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_2h">2 Saat</label>
                                                        <small class="form-text text-muted">Orta-uzun vadeli işlemler için</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_4h" name="timeframes[]" value="4h" 
                                                               <?php echo isset($settings['timeframes']) && in_array('4h', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_4h">4 Saat</label>
                                                        <small class="form-text text-muted">Orta-uzun vadeli analizler için</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_6h" name="timeframes[]" value="6h" 
                                                               <?php echo isset($settings['timeframes']) && in_array('6h', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_6h">6 Saat</label>
                                                        <small class="form-text text-muted">Uzun vadeli analizler için</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_12h" name="timeframes[]" value="12h" 
                                                               <?php echo isset($settings['timeframes']) && in_array('12h', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_12h">12 Saat</label>
                                                        <small class="form-text text-muted">Uzun vadeli trendler için</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_1d" name="timeframes[]" value="1d" 
                                                               <?php echo isset($settings['timeframes']) && in_array('1d', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_1d">1 Gün</label>
                                                        <small class="form-text text-muted">Günlük trendleri takip için</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="custom-control custom-checkbox">
                                                        <input type="checkbox" class="custom-control-input" id="timeframe_1w" name="timeframes[]" value="1w" 
                                                               <?php echo isset($settings['timeframes']) && in_array('1w', $settings['timeframes']) ? 'checked' : ''; ?>>
                                                        <label class="custom-control-label" for="timeframe_1w">1 Hafta</label>
                                                        <small class="form-text text-muted">Haftalık ana trendleri takip için</small>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row mt-4">
                                                <div class="col-md-12">
                                                    <div class="alert alert-warning">
                                                        <i class="fas fa-exclamation-triangle"></i> <strong>Not:</strong> Çok fazla zaman aralığı seçmek sistem performansını etkileyebilir. Birbiriyle uyumlu 3-5 farklı zaman aralığı seçmeniz önerilir.
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label for="primary_timeframe">Birincil Zaman Aralığı</label>
                                                        <select name="primary_timeframe" id="primary_timeframe" class="form-control">
                                                            <option value="1m" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '1m' ? 'selected' : ''; ?>>1 dakika</option>
                                                            <option value="3m" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '3m' ? 'selected' : ''; ?>>3 dakika</option>
                                                            <option value="5m" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '5m' ? 'selected' : ''; ?>>5 dakika</option>
                                                            <option value="15m" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '15m' ? 'selected' : ''; ?>>15 dakika</option>
                                                            <option value="30m" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '30m' ? 'selected' : ''; ?>>30 dakika</option>
                                                            <option value="1h" <?php echo !isset($settings['primary_timeframe']) || $settings['primary_timeframe'] == '1h' ? 'selected' : ''; ?>>1 saat</option>
                                                            <option value="2h" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '2h' ? 'selected' : ''; ?>>2 saat</option>
                                                            <option value="4h" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '4h' ? 'selected' : ''; ?>>4 saat</option>
                                                            <option value="6h" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '6h' ? 'selected' : ''; ?>>6 saat</option>
                                                            <option value="12h" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '12h' ? 'selected' : ''; ?>>12 saat</option>
                                                            <option value="1d" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '1d' ? 'selected' : ''; ?>>1 gün</option>
                                                            <option value="1w" <?php echo isset($settings['primary_timeframe']) && $settings['primary_timeframe'] == '1w' ? 'selected' : ''; ?>>1 hafta</option>
                                                        </select>
                                                        <small class="form-text text-muted">Seçilen zaman aralıkları arasında çakışma olduğunda öncelik verilecek zaman aralığı</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0"><i class="fas fa-sliders-h"></i> Çoklu Timeframe Ayarları</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="timeframe_weight_short">Kısa Vadeli Ağırlık (%)</label>
                                                        <input type="number" name="timeframe_weight_short" id="timeframe_weight_short" class="form-control" 
                                                               value="<?php echo isset($settings['timeframe_weight_short']) ? $settings['timeframe_weight_short'] : 25; ?>" min="0" max="100">
                                                        <small class="form-text text-muted">Kısa vadeli zaman aralıklarının (1m-15m) karar alma sürecindeki ağırlığı</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="timeframe_weight_medium">Orta Vadeli Ağırlık (%)</label>
                                                        <input type="number" name="timeframe_weight_medium" id="timeframe_weight_medium" class="form-control" 
                                                               value="<?php echo isset($settings['timeframe_weight_medium']) ? $settings['timeframe_weight_medium'] : 50; ?>" min="0" max="100">
                                                        <small class="form-text text-muted">Orta vadeli zaman aralıklarının (30m-4h) karar alma sürecindeki ağırlığı</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="timeframe_weight_long">Uzun Vadeli Ağırlık (%)</label>
                                                        <input type="number" name="timeframe_weight_long" id="timeframe_weight_long" class="form-control" 
                                                               value="<?php echo isset($settings['timeframe_weight_long']) ? $settings['timeframe_weight_long'] : 25; ?>" min="0" max="100">
                                                        <small class="form-text text-muted">Uzun vadeli zaman aralıklarının (6h-1w) karar alma sürecindeki ağırlığı</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="timeframe_consensus">Konsensus Gerekliliği</label>
                                                        <select name="timeframe_consensus" id="timeframe_consensus" class="form-control">
                                                            <option value="any" <?php echo isset($settings['timeframe_consensus']) && $settings['timeframe_consensus'] == 'any' ? 'selected' : ''; ?>>Herhangi bir zaman aralığı</option>
                                                            <option value="majority" <?php echo !isset($settings['timeframe_consensus']) || $settings['timeframe_consensus'] == 'majority' ? 'selected' : ''; ?>>Çoğunluk (>50%)</option>
                                                            <option value="strong" <?php echo isset($settings['timeframe_consensus']) && $settings['timeframe_consensus'] == 'strong' ? 'selected' : ''; ?>>Güçlü çoğunluk (>75%)</option>
                                                            <option value="all" <?php echo isset($settings['timeframe_consensus']) && $settings['timeframe_consensus'] == 'all' ? 'selected' : ''; ?>>Tüm zaman aralıkları</option>
                                                        </select>
                                                        <small class="form-text text-muted">İşlem sinyali üretilmesi için gereken zaman aralığı uyumu</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Otomatik Keşif Ayarları -->
                                <div class="tab-pane fade" id="auto-discovery" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Otomatik Coin Keşfetme Ayarları</h6>
                                            <p class="mb-0">Otomatik coin keşfetme özelliği, belirli kriterlere göre yeni coinleri tarar ve keşfeder. Bu özellik, botun sürekli olarak yeni fırsatları değerlendirmesini sağlar.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="feature-card mb-4 <?php echo isset($settings['auto_discovery']['enabled']) && $settings['auto_discovery']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-search-dollar"></i> Otomatik Keşif</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="auto_discovery_enabled" name="auto_discovery_enabled"
                                                       <?php echo isset($settings['auto_discovery']['enabled']) && $settings['auto_discovery']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="auto_discovery_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                Otomatik coin keşfetme özelliği, belirli kriterlere göre yeni coinleri tarar ve keşfeder. Bu özellik, botun sürekli olarak yeni fırsatları değerlendirmesini sağlar.
                                            </p>
                                            
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="discovery_interval">
                                                            Keşif Aralığı
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Yeni coinleri tarama aralığı (saniye cinsinden)"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-clock"></i></span>
                                                            </div>
                                                            <input type="number" name="discovery_interval" id="discovery_interval" class="form-control" 
                                                                   value="<?php echo isset($settings['auto_discovery']['discovery_interval']) ? $settings['auto_discovery']['discovery_interval'] : 600; ?>" min="60" max="3600">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">saniye</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: 600 saniye (10 dakika)</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="min_volume_for_discovery">
                                                            Minimum Hacim
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Keşfedilecek coinler için minimum günlük işlem hacmi"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-chart-bar"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="min_volume_for_discovery" id="min_volume_for_discovery" class="form-control" 
                                                                   value="<?php echo isset($settings['auto_discovery']['min_volume_for_discovery']) ? $settings['auto_discovery']['min_volume_for_discovery'] : 1000; ?>" min="100" max="10000">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text"><?php echo $settings['base_currency']; ?></span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: 1000</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="min_price_change">
                                                            Minimum Fiyat Değişimi
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Keşfedilecek coinler için minimum fiyat değişim yüzdesi"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-percentage"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="min_price_change" id="min_price_change" class="form-control" 
                                                                   value="<?php echo isset($settings['auto_discovery']['min_price_change']) ? $settings['auto_discovery']['min_price_change'] : 5; ?>" min="1" max="100">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: %5</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="min_volume_change">
                                                            Minimum Hacim Değişimi
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Keşfedilecek coinler için minimum hacim değişim yüzdesi"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-chart-line"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="min_volume_change" id="min_volume_change" class="form-control" 
                                                                   value="<?php echo isset($settings['auto_discovery']['min_volume_change']) ? $settings['auto_discovery']['min_volume_change'] : 10; ?>" min="1" max="100">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: %10</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="max_coins_to_discover">
                                                            Maksimum Keşfedilecek Coin Sayısı
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Aynı anda keşfedilecek maksimum coin sayısı"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-coins"></i></span>
                                                            </div>
                                                            <input type="number" name="max_coins_to_discover" id="max_coins_to_discover" class="form-control" 
                                                                   value="<?php echo isset($settings['auto_discovery']['max_coins_to_discover']) ? $settings['auto_discovery']['max_coins_to_discover'] : 10; ?>" min="1" max="50">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">adet</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: 10</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>
                                                            Keşfedilen Coinleri İzleme Listesine Otomatik Ekle
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Keşfedilen coinleri otomatik olarak izleme listesine ekler"></i>
                                                        </label>
                                                        <div class="custom-control custom-switch mt-2">
                                                            <input type="checkbox" class="custom-control-input" id="auto_add_to_watchlist" name="auto_add_to_watchlist"
                                                                   <?php echo isset($settings['auto_discovery']['auto_add_to_watchlist']) && $settings['auto_discovery']['auto_add_to_watchlist'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="auto_add_to_watchlist">Otomatik Ekle</label>
                                                        </div>
                                                        <small class="form-text text-muted">Keşfedilen coinler izleme listesine otomatik olarak eklenir</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                  <!-- İndikatör Ayarları -->
                                <div class="tab-pane fade" id="indicators" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">İndikatör Ayarları Hakkında</h6>
                                            <p class="mb-0">İndikatörler, fiyat verilerini analiz ederek alım-satım sinyalleri üretir. Etkinleştirdiğiniz indikatörler botun karar verme sürecinde kullanılacaktır. Her indikatör farklı piyasa koşullarında farklı performans gösterebilir.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="alert alert-info mb-4">
                                        <i class="fas fa-shield-alt"></i> İndikatör bazlı risk yönetimi seçenekleri için lütfen "Risk Yönetimi" ve "Gelişmiş Risk Yönetimi" sekmelerini kullanın. İndikatör sinyalleri risk yönetimi kurallarına göre filtrelenir.

                                    <div class="alert alert-info">
                                        <i class="fas fa-lightbulb"></i> <strong>Öneri:</strong> Piyasa koşullarına göre indikatör kombinasyonlarını değiştirmeyi unutmayın. Trendsiz piyasada osilatörleri, trendli piyasada trend takip eden indikatörleri tercih edin.
                                    </div>

                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle"></i> <strong>Not:</strong> Çok fazla indikatör kullanmak karmaşaya ve yanlış sinyallere neden olabilir. 3-4 tamamlayıcı indikatör ile başlayın.
                                    </div>
                                    
                                    <!-- Bollinger Bands -->
                                    <div class="feature-card mb-4 <?php echo $settings['indicators']['bollinger_bands']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-area"></i> Bollinger Bands</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="bb_enabled" name="bb_enabled"
                                                       <?php echo $settings['indicators']['bollinger_bands']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="bb_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                Bollinger Bands, fiyat volatilitesini ölçer ve potansiyel aşırı alım veya aşırı satım bölgelerini belirlemenize yardımcı olur. 
                                                Orta bant, bir hareketli ortalamadır; üst ve alt bantlar ise standart sapma çarpanlarıdır.
                                            </p>
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="bb_window">Pencere Boyutu</label>
                                                        <input type="number" name="bb_window" id="bb_window" class="form-control" 
                                                               value="<?php echo $settings['indicators']['bollinger_bands']['window']; ?>">
                                                        <small class="form-text text-muted">Hesaplama için kullanılacak periyot sayısı</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="bb_num_std">Standart Sapma</label>
                                                        <input type="number" step="0.1" name="bb_num_std" id="bb_num_std" class="form-control" 
                                                               value="<?php echo $settings['indicators']['bollinger_bands']['num_std']; ?>">
                                                        <small class="form-text text-muted">Üst ve alt bantlar için standart sapma çarpanı</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- RSI -->
                                    <div class="feature-card mb-4 <?php echo $settings['indicators']['rsi']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-line"></i> RSI (Göreceli Güç İndeksi)</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="rsi_enabled" name="rsi_enabled"
                                                       <?php echo $settings['indicators']['rsi']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="rsi_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                RSI (Relative Strength Index), bir varlığın aşırı alım veya aşırı satım durumlarını belirlemek için kullanılan bir momentum osilatörüdür.
                                                RSI değeri 0 ile 100 arasında değişir; genellikle 70'in üzerinde aşırı alım, 30'un altında aşırı satım olarak kabul edilir.
                                            </p>
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="rsi_window">Pencere Boyutu</label>
                                                        <input type="number" name="rsi_window" id="rsi_window" class="form-control" 
                                                               value="<?php echo $settings['indicators']['rsi']['window']; ?>">
                                                        <small class="form-text text-muted">Hesaplama için kullanılacak periyot sayısı</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- MACD -->
                                    <div class="feature-card mb-4 <?php echo $settings['indicators']['macd']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-bar"></i> MACD (Hareketli Ortalama Yakınsama/Iraksama)</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="macd_enabled" name="macd_enabled"
                                                       <?php echo $settings['indicators']['macd']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="macd_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                MACD, trendin yönünü, momentumunu ve süresini belirlemek için kullanılan bir trend takip ve momentum indikatörüdür.
                                                Kısa ve uzun vadeli hareketli ortalamaların farkını ve bunların sinyal çizgisini kullanır.
                                            </p>
                                            <div class="row mt-4">
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="macd_fast">Hızlı MA</label>
                                                        <input type="number" name="macd_fast" id="macd_fast" class="form-control" 
                                                               value="<?php echo $settings['indicators']['macd']['fast_period']; ?>">
                                                        <small class="form-text text-muted">Hızlı hareketli ortalama periyodu</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="macd_slow">Yavaş MA</label>
                                                        <input type="number" name="macd_slow" id="macd_slow" class="form-control" 
                                                               value="<?php echo $settings['indicators']['macd']['slow_period']; ?>">
                                                        <small class="form-text text-muted">Yavaş hareketli ortalama periyodu</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="macd_signal">Sinyal</label>
                                                        <input type="number" name="macd_signal" id="macd_signal" class="form-control" 
                                                               value="<?php echo $settings['indicators']['macd']['signal_period']; ?>">
                                                        <small class="form-text text-muted">Sinyal hattı periyodu</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Hareketli Ortalama -->
                                    <div class="feature-card mb-4 <?php echo $settings['indicators']['moving_average']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-wave-square"></i> Hareketli Ortalamalar</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="ma_enabled" name="ma_enabled"
                                                       <?php echo $settings['indicators']['moving_average']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="ma_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                Hareketli ortalamalar, belirli bir süre boyunca fiyat hareketlerinin düzleştirilmiş değerleridir ve trend yönünü belirlemek için kullanılır. 
                                                Kısa ve uzun dönem hareketli ortalamaların kesişimi, trend değişimlerini işaret eder.
                                            </p>
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="ma_short">Kısa MA</label>
                                                        <input type="number" name="ma_short" id="ma_short" class="form-control" 
                                                               value="<?php echo $settings['indicators']['moving_average']['short_window']; ?>">
                                                        <small class="form-text text-muted">Kısa dönem hareketli ortalama periyodu</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="ma_long">Uzun MA</label>
                                                        <input type="number" name="ma_long" id="ma_long" class="form-control" 
                                                               value="<?php echo $settings['indicators']['moving_average']['long_window']; ?>">
                                                        <small class="form-text text-muted">Uzun dönem hareketli ortalama periyodu</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Supertrend -->
                                    <div class="feature-card mb-4 <?php echo isset($settings['indicators']['supertrend']['enabled']) && $settings['indicators']['supertrend']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-route"></i> Supertrend</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="supertrend_enabled" name="supertrend_enabled"
                                                       <?php echo isset($settings['indicators']['supertrend']['enabled']) && $settings['indicators']['supertrend']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="supertrend_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                Supertrend, trend yönünü belirlemek için kullanılan güçlü bir teknik indikatördür. 
                                                ATR (Average True Range) ve fiyat hareketlerini temel alarak alım-satım sinyalleri üretir.
                                            </p>
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="supertrend_period">Periyot</label>
                                                        <input type="number" name="supertrend_period" id="supertrend_period" class="form-control" 
                                                               value="<?php echo isset($settings['indicators']['supertrend']['period']) ? $settings['indicators']['supertrend']['period'] : 10; ?>">
                                                        <small class="form-text text-muted">ATR hesaplama periyodu</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="supertrend_multiplier">Çarpan</label>
                                                        <input type="number" step="0.1" name="supertrend_multiplier" id="supertrend_multiplier" class="form-control" 
                                                               value="<?php echo isset($settings['indicators']['supertrend']['multiplier']) ? $settings['indicators']['supertrend']['multiplier'] : 3.0; ?>">
                                                        <small class="form-text text-muted">ATR çarpanı</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Stochastic -->
                                    <div class="feature-card mb-4 <?php echo isset($settings['indicators']['stochastic']['enabled']) && $settings['indicators']['stochastic']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-percent"></i> Stochastic Oscillator</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="stochastic_enabled" name="stochastic_enabled"
                                                       <?php echo isset($settings['indicators']['stochastic']['enabled']) && $settings['indicators']['stochastic']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="stochastic_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                Stochastic Oscillator, mevcut fiyatın belirli bir zaman dilimindeki fiyat aralığına göre pozisyonunu ölçen bir momentum indikatörüdür.
                                                Aşırı alım ve aşırı satım seviyelerini tespit etmekte kullanılır.
                                            </p>
                                            <div class="row mt-4">
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="stochastic_k_period">K Periyodu</label>
                                                        <input type="number" name="stochastic_k_period" id="stochastic_k_period" class="form-control" 
                                                               value="<?php echo isset($settings['indicators']['stochastic']['k_period']) ? $settings['indicators']['stochastic']['k_period'] : 14; ?>">
                                                        <small class="form-text text-muted">%K periyodu</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="stochastic_d_period">D Periyodu</label>
                                                        <input type="number" name="stochastic_d_period" id="stochastic_d_period" class="form-control" 
                                                               value="<?php echo isset($settings['indicators']['stochastic']['d_period']) ? $settings['indicators']['stochastic']['d_period'] : 3; ?>">
                                                        <small class="form-text text-muted">%D periyodu</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="stochastic_slowing">Yavaşlama</label>
                                                        <input type="number" name="stochastic_slowing" id="stochastic_slowing" class="form-control" 
                                                               value="<?php echo isset($settings['indicators']['stochastic']['slowing']) ? $settings['indicators']['stochastic']['slowing'] : 3; ?>">
                                                        <small class="form-text text-muted">Yavaşlama periyodu</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- İndikatör Sinyalleri -->
                                <div class="tab-pane fade" id="indicator-signals" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">İndikatör Sinyal Ayarları</h6>
                                            <p class="mb-0">Bu bölümde her bir indikatörün sinyal üretme koşullarını ve karar verme sisteminde kullanılacak ağırlıklarını özelleştirebilirsiniz. Bu sayede stratejinize ve piyasa koşullarına en uygun sinyal sistemini oluşturabilirsiniz.</p>
                                        </div>
                                    </div>

                                    <!-- Genel Sinyal Ayarları -->
                                    <div class="feature-card mb-4 enabled">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-sliders-h"></i> Sinyal Sistemi Genel Ayarları</h5>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="signal_consensus_method">Sinyal Uzlaşma Metodu</label>
                                                        <select class="form-control" id="signal_consensus_method" name="signal_consensus_method">
                                                            <option value="weighted" <?php echo isset($settings['signal_consensus_method']) && $settings['signal_consensus_method'] == 'weighted' ? 'selected' : ''; ?>>Ağırlıklı Ortalama (önerilen)</option>
                                                            <option value="majority" <?php echo isset($settings['signal_consensus_method']) && $settings['signal_consensus_method'] == 'majority' ? 'selected' : ''; ?>>Çoğunluk Yöntemi</option>
                                                            <option value="strongest" <?php echo isset($settings['signal_consensus_method']) && $settings['signal_consensus_method'] == 'strongest' ? 'selected' : ''; ?>>En Güçlü Sinyal</option>
                                                        </select>
                                                        <small class="form-text text-muted">Farklı indikatörlerin sinyallerinin nasıl birleştirileceğini belirler.</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="signal_consensus_threshold">Sinyal Güç Eşiği</label>
                                                        <input type="range" class="custom-range" min="0" max="100" step="5" id="signal_consensus_threshold" name="signal_consensus_threshold" 
                                                            value="<?php echo isset($settings['signal_consensus_threshold']) ? $settings['signal_consensus_threshold'] : '60'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">Düşük (0)</small>
                                                            <small class="text-primary" id="signal_threshold_value"><?php echo isset($settings['signal_consensus_threshold']) ? $settings['signal_consensus_threshold'] : '60'; ?>%</small>
                                                            <small class="text-muted">Yüksek (100)</small>
                                                        </div>
                                                        <small class="form-text text-muted">İşlem sinyali oluşturmak için gereken minimum uzlaşma yüzdesi</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="signal_confirmation_count">Sinyal Onaylama Sayısı</label>
                                                        <input type="number" class="form-control" id="signal_confirmation_count" name="signal_confirmation_count" min="1" max="10" 
                                                            value="<?php echo isset($settings['signal_confirmation_count']) ? $settings['signal_confirmation_count'] : '2'; ?>">
                                                        <small class="form-text text-muted">Bir sinyalin güvenilir kabul edilmesi için kaç ardışık dönemde onaylanması gerektiği</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="signal_conflicting_action">Çelişkili Sinyaller Durumunda</label>
                                                        <select class="form-control" id="signal_conflicting_action" name="signal_conflicting_action">
                                                            <option value="wait" <?php echo isset($settings['signal_conflicting_action']) && $settings['signal_conflicting_action'] == 'wait' ? 'selected' : ''; ?>>Bekle (işlem yapma)</option>
                                                            <option value="follow_trend" <?php echo isset($settings['signal_conflicting_action']) && $settings['signal_conflicting_action'] == 'follow_trend' ? 'selected' : ''; ?>>Ana trendi takip et</option>
                                                            <option value="follow_timeframe" <?php echo isset($settings['signal_conflicting_action']) && $settings['signal_conflicting_action'] == 'follow_timeframe' ? 'selected' : ''; ?>>Birincil zaman aralığını takip et</option>
                                                        </select>
                                                        <small class="form-text text-muted">Zaman aralıkları arasında veya indikatörler arasında çelişki olduğunda izlenecek strateji</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="alert alert-info mt-2">
                                                <i class="fas fa-info-circle mr-2"></i> <strong>İpucu:</strong> Sinyallerin ağırlıklarını ve eşik değerlerini piyasa koşullarına göre ayarlayabilirsiniz. Trend piyasasında trend takip eden indikatörlere daha fazla ağırlık verirken, yatay piyasada osilatörlere daha fazla ağırlık vermek etkili olabilir.
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- İndikatör Sinyal Ağırlıkları -->
                                    <div class="feature-card mb-4 enabled">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-balance-scale"></i> İndikatör Ağırlıkları</h5>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                Her indikatöre farklı ağırlıklar vererek botun karar verme sistemini özelleştirebilirsiniz. Ağırlıkların toplamı %100 olmalıdır.
                                            </p>
                                            
                                            <div class="row">
                                                <div class="col-md-12 mb-3">
                                                    <div class="progress" style="height: 25px;">
                                                        <div class="progress-bar bg-success" id="weight-progress-bar" style="width: 0%">
                                                            <span id="total-weight">0%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">RSI</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="rsi_weight" name="rsi_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['rsi']) ? $settings['indicator_weights']['rsi'] : '20'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">MACD</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="macd_weight" name="macd_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['macd']) ? $settings['indicator_weights']['macd'] : '15'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">Bollinger</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="bollinger_weight" name="bollinger_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['bollinger_bands']) ? $settings['indicator_weights']['bollinger_bands'] : '15'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">Hareketli Ort.</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="ma_weight" name="ma_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['moving_average']) ? $settings['indicator_weights']['moving_average'] : '15'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">Supertrend</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="supertrend_weight" name="supertrend_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['supertrend']) ? $settings['indicator_weights']['supertrend'] : '15'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">Stochastic</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="stochastic_weight" name="stochastic_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['stochastic']) ? $settings['indicator_weights']['stochastic'] : '10'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">ADX</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="adx_weight" name="adx_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['adx']) ? $settings['indicator_weights']['adx'] : '5'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <div class="input-group">
                                                        <div class="input-group-prepend">
                                                            <span class="input-group-text">Diğer</span>
                                                        </div>
                                                        <input type="number" class="form-control weight-input" id="other_weight" name="other_weight" min="0" max="100" 
                                                               value="<?php echo isset($settings['indicator_weights']['other']) ? $settings['indicator_weights']['other'] : '5'; ?>">
                                                        <div class="input-group-append">
                                                            <span class="input-group-text">%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-2">
                                                <div class="col-md-12">
                                                    <div class="alert" id="weight-alert" role="alert">
                                                        Lütfen indikatör ağırlıklarının toplamının %100 olduğundan emin olun.
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- RSI Sinyalleri -->
                                    <div class="feature-card mb-4 <?php echo $settings['indicators']['rsi']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-line"></i> RSI Sinyal Ayarları</h5>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="rsi_oversold">Aşırı Satım Seviyesi (Alım Sinyali)</label>
                                                        <input type="range" class="custom-range" min="10" max="40" step="1" id="rsi_oversold" name="rsi_oversold" 
                                                               value="<?php echo isset($settings['indicator_signals']['rsi']['oversold']) ? $settings['indicator_signals']['rsi']['oversold'] : '30'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">10</small>
                                                            <small class="text-success" id="rsi_oversold_value"><?php echo isset($settings['indicator_signals']['rsi']['oversold']) ? $settings['indicator_signals']['rsi']['oversold'] : '30'; ?></small>
                                                            <small class="text-muted">40</small>
                                                        </div>
                                                        <small class="form-text text-muted">RSI değeri bu seviyenin altına düştüğünde alım sinyali oluşturulur.</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="rsi_overbought">Aşırı Alım Seviyesi (Satım Sinyali)</label>
                                                        <input type="range" class="custom-range" min="60" max="90" step="1" id="rsi_overbought" name="rsi_overbought" 
                                                               value="<?php echo isset($settings['indicator_signals']['rsi']['overbought']) ? $settings['indicator_signals']['rsi']['overbought'] : '70'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">60</small>
                                                            <small class="text-danger" id="rsi_overbought_value"><?php echo isset($settings['indicator_signals']['rsi']['overbought']) ? $settings['indicator_signals']['rsi']['overbought'] : '70'; ?></small>
                                                            <small class="text-muted">90</small>
                                                        </div>
                                                        <small class="form-text text-muted">RSI değeri bu seviyenin üzerine çıktığında satım sinyali oluşturulur.</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="rsi_center_line_cross">Orta Çizgi Kesişimi Sinyali</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="rsi_center_line_cross" name="rsi_center_line_cross"
                                                                  <?php echo isset($settings['indicator_signals']['rsi']['center_line_cross']) && $settings['indicator_signals']['rsi']['center_line_cross'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="rsi_center_line_cross">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">RSI'ın 50 seviyesini kesmesini sinyal olarak kullan.</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="rsi_divergence">RSI Uyumsuzluğunu (Divergence) Algıla</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="rsi_divergence" name="rsi_divergence"
                                                                  <?php echo isset($settings['indicator_signals']['rsi']['divergence']) && $settings['indicator_signals']['rsi']['divergence'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="rsi_divergence">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Fiyat ve RSI arasındaki uyumsuzlukları tespit et ve sinyal olarak kullan.</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Bollinger Bands Sinyalleri -->
                                    <div class="feature-card mb-4 <?php echo $settings['indicators']['bollinger_bands']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-area"></i> Bollinger Bands Sinyal Ayarları</h5>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="bb_squeeze_threshold">Bollinger Sıkışma Eşiği</label>
                                                        <input type="range" class="custom-range" min="1" max="10" step="0.5" id="bb_squeeze_threshold" name="bb_squeeze_threshold" 
                                                               value="<?php echo isset($settings['indicator_signals']['bollinger_bands']['squeeze_threshold']) ? $settings['indicator_signals']['bollinger_bands']['squeeze_threshold'] : '3'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">Düşük (1)</small>
                                                            <small class="text-primary" id="bb_squeeze_threshold_value"><?php echo isset($settings['indicator_signals']['bollinger_bands']['squeeze_threshold']) ? $settings['indicator_signals']['bollinger_bands']['squeeze_threshold'] : '3'; ?></small>
                                                            <small class="text-muted">Yüksek (10)</small>
                                                        </div>
                                                        <small class="form-text text-muted">Bollinger bantlarının sıkıştığını (volatilitenin çok düşük olduğunu) tespit etmek için eşik değeri.</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="bb_breakout_confirmation_candles">Kırılma Onayı için Mum Sayısı</label>
                                                        <input type="number" class="form-control" id="bb_breakout_confirmation_candles" name="bb_breakout_confirmation_candles" min="1" max="5" 
                                                               value="<?php echo isset($settings['indicator_signals']['bollinger_bands']['breakout_confirmation_candles']) ? $settings['indicator_signals']['bollinger_bands']['breakout_confirmation_candles'] : '2'; ?>">
                                                        <small class="form-text text-muted">Bollinger bantlarında kırılma sonrası kaç mumun onay için bekleneceği</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="bb_percentage_b">%B Kullanımı</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="bb_percentage_b" name="bb_percentage_b"
                                                                  <?php echo isset($settings['indicator_signals']['bollinger_bands']['use_percentage_b']) && $settings['indicator_signals']['bollinger_bands']['use_percentage_b'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="bb_percentage_b">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Fiyatın Bollinger bantları içindeki konumunun yüzdesel değerini kullan (%B).</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="bb_mean_reversion">Ortalamaya Dönüş Stratejisi</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="bb_mean_reversion" name="bb_mean_reversion"
                                                                  <?php echo isset($settings['indicator_signals']['bollinger_bands']['mean_reversion']) && $settings['indicator_signals']['bollinger_bands']['mean_reversion'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="bb_mean_reversion">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Fiyatların orta banda geri dönüş eğiliminden sinyal üret.</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- MACD Sinyalleri -->
                                    <div class="feature-card mb-4 <?php echo $settings['indicators']['macd']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-bar"></i> MACD Sinyal Ayarları</h5>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="macd_signal_strength">Kesişim Sinyal Gücü</label>
                                                        <input type="range" class="custom-range" min="0" max="1" step="0.05" id="macd_signal_strength" name="macd_signal_strength" 
                                                               value="<?php echo isset($settings['indicator_signals']['macd']['signal_strength']) ? $settings['indicator_signals']['macd']['signal_strength'] : '0.2'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">Zayıf (0)</small>
                                                            <small class="text-primary" id="macd_signal_strength_value"><?php echo isset($settings['indicator_signals']['macd']['signal_strength']) ? $settings['indicator_signals']['macd']['signal_strength'] : '0.2'; ?></small>
                                                            <small class="text-muted">Güçlü (1)</small>
                                                        </div>
                                                        <small class="form-text text-muted">MACD çizgisi ile sinyal çizgisinin kesişme noktasındaki minimum fark</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="macd_zero_line_cross">Sıfır Çizgi Kesişimi</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="macd_zero_line_cross" name="macd_zero_line_cross"
                                                                  <?php echo isset($settings['indicator_signals']['macd']['zero_line_cross']) && $settings['indicator_signals']['macd']['zero_line_cross'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="macd_zero_line_cross">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">MACD çizgisinin sıfır çizgisini kesmesini sinyal olarak kullan.</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="macd_histogram_divergence">Histogram Uyumsuzluğu (Divergence)</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="macd_histogram_divergence" name="macd_histogram_divergence"
                                                                  <?php echo isset($settings['indicator_signals']['macd']['histogram_divergence']) && $settings['indicator_signals']['macd']['histogram_divergence'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="macd_histogram_divergence">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">MACD histogramı ve fiyat arasındaki uyumsuzlukları sinyal olarak kullan.</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="macd_trigger_type">Tetikleme Tipi</label>
                                                        <select class="form-control" id="macd_trigger_type" name="macd_trigger_type">
                                                            <option value="crossover" <?php echo isset($settings['indicator_signals']['macd']['trigger_type']) && $settings['indicator_signals']['macd']['trigger_type'] == 'crossover' ? 'selected' : ''; ?>>Kesişim (Crossover)</option>
                                                            <option value="convergence" <?php echo isset($settings['indicator_signals']['macd']['trigger_type']) && $settings['indicator_signals']['macd']['trigger_type'] == 'convergence' ? 'selected' : ''; ?>>Yakınsama (Convergence)</option>
                                                            <option value="both" <?php echo isset($settings['indicator_signals']['macd']['trigger_type']) && $settings['indicator_signals']['macd']['trigger_type'] == 'both' ? 'selected' : ''; ?>>Her İkisi de</option>
                                                        </select>
                                                        <small class="form-text text-muted">MACD sinyalini tetikleyecek olayın tipi</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Supertrend Sinyalleri -->
                                    <div class="feature-card mb-4 <?php echo isset($settings['indicators']['supertrend']['enabled']) && $settings['indicators']['supertrend']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-route"></i> Supertrend Sinyal Ayarları</h5>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="supertrend_confirmation_candles">Onay için Mum Sayısı</label>
                                                        <input type="number" class="form-control" id="supertrend_confirmation_candles" name="supertrend_confirmation_candles" min="1" max="5" 
                                                               value="<?php echo isset($settings['indicator_signals']['supertrend']['confirmation_candles']) ? $settings['indicator_signals']['supertrend']['confirmation_candles'] : '1'; ?>">
                                                        <small class="form-text text-muted">Supertrend değişim sinyali sonrası kaç mumun onay için bekleneceği</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="supertrend_filter_adx">ADX ile Filtrele</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="supertrend_filter_adx" name="supertrend_filter_adx"
                                                                  <?php echo isset($settings['indicator_signals']['supertrend']['filter_adx']) && $settings['indicator_signals']['supertrend']['filter_adx'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="supertrend_filter_adx">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">ADX değerini kullanarak zayıf trendlerden kaçının.</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="supertrend_adx_threshold">ADX Eşik Değeri</label>
                                                        <input type="range" class="custom-range" min="10" max="40" step="1" id="supertrend_adx_threshold" name="supertrend_adx_threshold" 
                                                               value="<?php echo isset($settings['indicator_signals']['supertrend']['adx_threshold']) ? $settings['indicator_signals']['supertrend']['adx_threshold'] : '25'; ?>"
                                                               <?php echo isset($settings['indicator_signals']['supertrend']['filter_adx']) && $settings['indicator_signals']['supertrend']['filter_adx'] ? '' : 'disabled'; ?>>
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">10</small>
                                                            <small class="text-primary" id="supertrend_adx_threshold_value"><?php echo isset($settings['indicator_signals']['supertrend']['adx_threshold']) ? $settings['indicator_signals']['supertrend']['adx_threshold'] : '25'; ?></small>
                                                            <small class="text-muted">40</small>
                                                        </div>
                                                        <small class="form-text text-muted">Supertrend sinyallerinin dikkate alınması için gereken minimum ADX değeri.</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <script>
                                        // Bu kod ağırlık toplamını kontrol eder ve progress bar'ı günceller
                                        $(document).ready(function() {
                                            function updateWeightTotal() {
                                                var sum = 0;
                                                $('.weight-input').each(function() {
                                                    sum += parseInt($(this).val()) || 0;
                                                });
                                                
                                                $('#total-weight').text(sum + '%');
                                                var progressBar = $('#weight-progress-bar');
                                                var alertBox = $('#weight-alert');
                                                
                                                if (sum === 100) {
                                                    progressBar.removeClass('bg-warning bg-danger').addClass('bg-success');
                                                    progressBar.css('width', '100%');
                                                    alertBox.removeClass('alert-warning alert-danger').addClass('alert-success');
                                                    alertBox.html('<i class="fas fa-check-circle"></i> Toplam ağırlık 100%. Mükemmel!');
                                                } else if (sum < 100) {
                                                    progressBar.removeClass('bg-success bg-danger').addClass('bg-warning');
                                                    progressBar.css('width', sum + '%');
                                                    alertBox.removeClass('alert-success alert-danger').addClass('alert-warning');
                                                    alertBox.html('<i class="fas fa-exclamation-circle"></i> Toplam ağırlık ' + sum + '%. 100% olması gerekiyor. Lütfen değerleri artırın.');
                                                } else {
                                                    progressBar.removeClass('bg-success bg-warning').addClass('bg-danger');
                                                    progressBar.css('width', '100%');
                                                    alertBox.removeClass('alert-success alert-warning').addClass('alert-danger');
                                                    alertBox.html('<i class="fas fa-exclamation-triangle"></i> Toplam ağırlık ' + sum + '%. 100%\'den büyük olamaz. Lütfen değerleri azaltın.');
                                                }
                                            }
                                            
                                            // İlk yüklemede çalıştır
                                            updateWeightTotal();
                                            
                                            // Değer değiştiğinde güncelle
                                            $('.weight-input').on('input change', function() {
                                                updateWeightTotal();
                                            });
                                            
                                            // Range input değerlerini gösterme
                                            $('#signal_consensus_threshold').on('input change', function() {
                                                $('#signal_threshold_value').text($(this).val() + '%');
                                            });
                                            
                                            $('#rsi_oversold').on('input change', function() {
                                                $('#rsi_oversold_value').text($(this).val());
                                            });
                                            
                                            $('#rsi_overbought').on('input change', function() {
                                                $('#rsi_overbought_value').text($(this).val());
                                            });
                                            
                                            $('#bb_squeeze_threshold').on('input change', function() {
                                                $('#bb_squeeze_threshold_value').text($(this).val());
                                            });
                                            
                                            $('#macd_signal_strength').on('input change', function() {
                                                $('#macd_signal_strength_value').text($(this).val());
                                            });
                                            
                                            $('#supertrend_adx_threshold').on('input change', function() {
                                                $('#supertrend_adx_threshold_value').text($(this).val());
                                            });
                                            
                                            // ADX filtre durumuna göre eşik değeri input'unu etkinleştir/devre dışı bırak
                                            $('#supertrend_filter_adx').change(function() {
                                                $('#supertrend_adx_threshold').prop('disabled', !$(this).prop('checked'));
                                            });
                                        });
                                    </script>
                                </div>
                                  <!-- Stratejiler -->
                                <div class="tab-pane fade" id="strategies" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Strateji Ayarları</h6>
                                            <p class="mb-0">Botun kullanacağı alım-satım stratejilerini bu bölümden etkinleştirebilir ve özelleştirebilirsiniz.</p>
                                        </div>
                                    </div>

                                    <div class="alert alert-info mb-4">
                                        <i class="fas fa-shield-alt"></i> Risk yönetimi ayarları için lütfen "Risk Yönetimi" ve "Gelişmiş Risk Yönetimi" sekmelerini kullanın. Strateji bazlı risk ayarları, genel risk yönetimi kuralları ile birlikte çalışır.
                                    </div>

                                    <div class="alert alert-info">
                                        <i class="fas fa-lightbulb"></i> <strong>Pro İpucu:</strong> Stratejilerinizi backtest yaparak test edin ve optimize edin. İyi çalışan bir stratejiyi gereksiz değişikliklerle bozmaktan kaçının.
                                    </div>

                                    <div class="alert alert-warning mb-4">
                                        <i class="fas fa-balance-scale"></i> <strong>Önemli:</strong> Her strateji farklı piyasa koşullarında farklı performans gösterir. Stratejinizi piyasa koşullarına göre seçin ve gerektiğinde değiştirin.
                                    </div>
                                    
                                    <!-- Kısa Vadeli Strateji -->
                                    <div class="feature-card mb-4 <?php echo isset($settings['strategies']['short_term']['enabled']) && $settings['strategies']['short_term']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-bolt"></i> Kısa Vadeli Strateji</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="short_term_enabled" name="short_term_enabled"
                                                       <?php echo isset($settings['strategies']['short_term']['enabled']) && $settings['strategies']['short_term']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="short_term_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="d-flex align-items-center mb-3">
                                                <span class="badge badge-primary mr-2">Hızlı</span>
                                                <span class="badge badge-info mr-2">Kısa vadeli</span>
                                                <span class="badge badge-secondary">Aşırı seviyelerde işlem</span>
                                            </div>
                                            <p class="feature-description">
                                                RSI ve Bollinger Bands indikatörlerini kullanarak aşırı alım/satım bölgelerinde işlem fırsatları arar.
                                                Yüksek volatilite dönemlerinde daha iyi performans gösterebilir.
                                            </p>
                                            <div class="mt-3">
                                                <h6 class="font-weight-bold small">Çalışma Prensibi:</h6>
                                                <ul class="small">
                                                    <li>RSI 30'un altına düştüğünde <span class="badge badge-success">ALIM</span> sinyali üretir</li>
                                                    <li>RSI 70'in üzerine çıktığında <span class="badge badge-danger">SATIM</span> sinyali üretir</li>
                                                    <li>Fiyat Bollinger alt bandına yakınsa alım sinyalini güçlendirir</li>
                                                    <li>Fiyat Bollinger üst bandına yakınsa satım sinyalini güçlendirir</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Trend Takip Stratejisi -->
                                    <div class="feature-card mb-4 <?php echo isset($settings['strategies']['trend_following']['enabled']) && $settings['strategies']['trend_following']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-line"></i> Trend Takip Stratejisi</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="trend_following_enabled" name="trend_following_enabled"
                                                       <?php echo isset($settings['strategies']['trend_following']['enabled']) && $settings['strategies']['trend_following']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="trend_following_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="d-flex align-items-center mb-3">
                                                <span class="badge badge-warning mr-2">Orta</span>
                                                <span class="badge badge-info mr-2">Orta vadeli</span>
                                                <span class="badge badge-secondary">Trend odaklı</span>
                                            </div>
                                            <p class="feature-description">
                                                Hareketli ortalamaların kesişimlerini kullanarak trend değişimlerini tespit eden ve bu yönde işlem yapan bir stratejidir.
                                                Güçlü trend dönemlerinde daha iyi performans gösterir.
                                            </p>
                                            <div class="mt-3">
                                                <h6 class="font-weight-bold small">Çalışma Prensibi:</h6>
                                                <ul class="small">
                                                    <li>Kısa MA uzun MA'yı yukarı kestiğinde (Golden Cross) <span class="badge badge-success">ALIM</span> sinyali üretir</li>
                                                    <li>Kısa MA uzun MA'yı aşağı kestiğinde (Death Cross) <span class="badge badge-danger">SATIM</span> sinyali üretir</li>
                                                    <li>Hacim artışı ile doğrulandığında sinyal güçlenir</li>
                                                    <li>RSI ile birlikte kullanıldığında daha etkili olabilir</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Kırılma Stratejisi -->
                                    <div class="feature-card mb-4 <?php echo isset($settings['strategies']['breakout']['enabled']) && $settings['strategies']['breakout']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-expand-arrows-alt"></i> Kırılma Stratejisi</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="breakout_enabled" name="breakout_enabled"
                                                       <?php echo isset($settings['strategies']['breakout']['enabled']) && $settings['strategies']['breakout']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="breakout_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="d-flex align-items-center mb-3">
                                                <span class="badge badge-danger mr-2">Agresif</span>
                                                <span class="badge badge-info mr-2">Ani hareketler</span>
                                                <span class="badge badge-secondary">Destek/Direnç odaklı</span>
                                            </div>
                                            <p class="feature-description">
                                                Fiyatın belirli bir süre içinde oluşan destek ve direnç seviyelerini kırması durumunda işlem yapan bir stratejidir.
                                                Piyasada güçlü hareketlerin olduğu dönemlerde etkilidir.
                                            </p>
                                            <div class="mt-3">
                                                <h6 class="font-weight-bold small">Çalışma Prensibi:</h6>
                                                <ul class="small">
                                                    <li>Son X periyottaki en yüksek seviyenin kırılması durumunda <span class="badge badge-success">ALIM</span> sinyali üretir</li>
                                                    <li>Son X periyottaki en düşük seviyenin kırılması durumunda <span class="badge badge-danger">SATIM</span> sinyali üretir</li>
                                                    <li>Hacim artışı ile desteklenen kırılmalar daha güvenilirdir</li>
                                                    <li>Volatilite düşük olduğunda yalancı sinyallere dikkat edilmelidir</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Volatilite Kırılma Stratejisi -->
                                    <div class="feature-card mb-4 <?php echo isset($settings['strategies']['volatility_breakout']['enabled']) && $settings['strategies']['volatility_breakout']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-pie"></i> Volatilite Kırılma Stratejisi</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="volatility_breakout_enabled" name="volatility_breakout_enabled"
                                                       <?php echo isset($settings['strategies']['volatility_breakout']['enabled']) && $settings['strategies']['volatility_breakout']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="volatility_breakout_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="d-flex align-items-center mb-3">
                                                <span class="badge badge-danger mr-2">Agresif</span>
                                                <span class="badge badge-info mr-2">Volatilite odaklı</span>
                                                <span class="badge badge-secondary">Hızlı hareketler</span>
                                            </div>
                                            <p class="feature-description">
                                                Fiyatın volatiliteye bağlı olarak ani hareketler yapması durumunda işlem yapan bir stratejidir.
                                                Piyasada yüksek volatilite dönemlerinde etkilidir.
                                            </p>
                                            <div class="mt-3">
                                                <h6 class="font-weight-bold small">Çalışma Prensibi:</h6>
                                                <ul class="small">
                                                    <li>Volatilite artışı ile desteklenen fiyat hareketlerinde <span class="badge badge-success">ALIM</span> veya <span class="badge badge-danger">SATIM</span> sinyali üretir</li>
                                                    <li>Hacim ve fiyat değişimlerini birlikte değerlendirir</li>
                                                    <li>Volatilite düşük olduğunda işlem yapmaz</li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="info-box warning mt-3">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Dikkat!</h6>
                                            <p class="mb-0">Her strateji farklı piyasa koşullarında farklı performans gösterir. Mevcut piyasa koşullarına göre en uygun stratejiyi seçmek veya birden fazla stratejiyi birlikte kullanmak daha iyi sonuçlar verebilir. Gerçek parayla işlem yapmadan önce stratejilerinizi backtesting ile test etmeniz önerilir.</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Risk Yönetimi -->                                <div class="tab-pane fade" id="risk-management" role="tabpanel">
                                    <div class="info-box warning mb-4">
                                        <i class="fas fa-shield-alt"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Risk Yönetimi</h6>
                                            <p class="mb-0">Risk yönetimi, yatırımınızı korumak için en önemli faktörlerden biridir. Doğru risk yönetimi stratejisi ile uzun vadede daha istikrarlı sonuçlar elde edebilirsiniz.</p>
                                        </div>
                                    </div>                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle"></i> <strong>İpucu:</strong> Her zaman sermayenizin sadece küçük bir yüzdesini riske atın. Stop-loss kullanmayı ihmal etmeyin ve risk-ödül oranınızı en az 1:2 olacak şekilde ayarlayın.
                                    </div>

                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle"></i> <strong>Dikkat:</strong> Risk yönetimi parametrelerini değiştirirken çok dikkatli olun. Yanlış ayarlar büyük kayıplara yol açabilir.
                                    </div>

                                    <div class="feature-card mb-4 <?php echo isset($settings['risk_management']['enabled']) && $settings['risk_management']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-shield-alt"></i> Risk Yönetimi</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="risk_enabled" name="risk_enabled"
                                                       <?php echo isset($settings['risk_management']['enabled']) && $settings['risk_management']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="risk_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="stop_loss">
                                                            Stop Loss (%)
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="İşlem için maksimum kayıp yüzdesi"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-chart-line"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="stop_loss" id="stop_loss" class="form-control" 
                                                                   value="<?php echo isset($settings['risk_management']['stop_loss']) ? $settings['risk_management']['stop_loss'] : 5; ?>" min="0.5" max="20">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: %2-5</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="take_profit">
                                                            Take Profit (%)
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="İşlem için hedef kâr yüzdesi"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-chart-line"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="take_profit" id="take_profit" class="form-control" 
                                                                   value="<?php echo isset($settings['risk_management']['take_profit']) ? $settings['risk_management']['take_profit'] : 10; ?>" min="1" max="50">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: %5-15</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Kaldıraç Ayarları Bölümü -->
                                            <div class="row mt-4">
                                                <div class="col-12">
                                                    <h5 class="font-weight-bold mb-3"><i class="fas fa-balance-scale-right"></i> Kaldıraç Ayarları</h5>
                                                    <div class="alert alert-info">
                                                        <i class="fas fa-info-circle"></i> Kaldıraç, potansiyel kârınızı artırabilir, ancak riskinizi de aynı oranda artırır. Dikkatli kullanın!
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="leverage">
                                                            Kaldıraç Oranı
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="İşlemlerde kullanılacak kaldıraç oranı"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-times"></i></span>
                                                            </div>
                                                            <select name="leverage" id="leverage" class="form-control">
                                                                <option value="1" <?php echo (isset($settings['leverage']) && $settings['leverage'] == 1) ? 'selected' : ''; ?>>1x (Kaldıraçsız)</option>
                                                                <option value="2" <?php echo (isset($settings['leverage']) && $settings['leverage'] == 2) ? 'selected' : ''; ?>>2x</option>
                                                                <option value="3" <?php echo (isset($settings['leverage']) && $settings['leverage'] == 3) ? 'selected' : ''; ?>>3x</option>
                                                                <option value="5" <?php echo (isset($settings['leverage']) && $settings['leverage'] == 5) ? 'selected' : ''; ?>>5x</option>
                                                                <option value="10" <?php echo (isset($settings['leverage']) && $settings['leverage'] == 10) ? 'selected' : ''; ?>>10x</option>
                                                                <option value="20" <?php echo (isset($settings['leverage']) && $settings['leverage'] == 20) ? 'selected' : ''; ?>>20x</option>
                                                            </select>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: 1x-3x (Başlangıç seviyesi)</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="leverage_mode">
                                                            Kaldıraç Modu
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Kaldıraç modu: Isolated (izole) veya Cross (çapraz)"></i>
                                                        </label>
                                                        <select name="leverage_mode" id="leverage_mode" class="form-control">
                                                            <option value="cross" <?php echo (isset($settings['leverage_mode']) && $settings['leverage_mode'] == 'cross') ? 'selected' : ''; ?>>Cross (Çapraz)</option>
                                                            <option value="isolated" <?php echo (isset($settings['leverage_mode']) && $settings['leverage_mode'] == 'isolated') ? 'selected' : ''; ?>>Isolated (İzole)</option>
                                                        </select>
                                                        <small class="form-text text-muted">Cross mod: Tüm bakiye likidasyon koruması için kullanılır. Isolated: Sadece ayrılan miktar risk altındadır.</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-12">
                                                    <div class="alert alert-warning">
                                                        <i class="fas fa-exclamation-triangle"></i> <strong>Uyarı:</strong> Kaldıraçlı işlemler yüksek risk taşır! Kaldıraç kullanmadan önce tam olarak nasıl çalıştığını anladığınızdan emin olun. 
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="trailing_stop">
                                                            Trailing Stop Kullan
                                                        </label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="trailing_stop" name="trailing_stop"
                                                                   <?php echo isset($settings['risk_management']['trailing_stop']) && $settings['risk_management']['trailing_stop'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="trailing_stop">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Fiyat yükseldikçe stop loss seviyesi de yükselir</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="trailing_stop_distance">
                                                            Trailing Stop Mesafesi (%)
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Fiyat ile trailing stop arasındaki yüzdesel mesafe"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-arrows-alt-v"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="trailing_stop_distance" id="trailing_stop_distance" class="form-control" 
                                                                   value="<?php echo isset($settings['risk_management']['trailing_stop_distance']) ? $settings['risk_management']['trailing_stop_distance'] : 2; ?>" min="0.5" max="10">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="trailing_stop_activation_pct">
                                                            Aktivasyon Yüzdesi
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Trailing stop'un aktif olması için gereken minimum kâr yüzdesi"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-percentage"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="trailing_stop_activation_pct" id="trailing_stop_activation_pct" class="form-control" 
                                                                   value="<?php echo isset($settings['risk_management']['trailing_stop_activation_pct']) ? $settings['risk_management']['trailing_stop_activation_pct'] : 3; ?>" min="0.5" max="10">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="trailing_stop_pct">
                                                            Trailing Stop (%)
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Trailing stop yüzdesi"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-chart-line"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="trailing_stop_pct" id="trailing_stop_pct" class="form-control" 
                                                                   value="<?php echo isset($settings['risk_management']['trailing_stop_pct']) ? $settings['risk_management']['trailing_stop_pct'] : 2; ?>" min="0.5" max="10">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="max_open_positions">
                                                            Maksimum Açık Pozisyon
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Aynı anda açık tutulabilecek maksimum pozisyon sayısı"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-layer-group"></i></span>
                                                            </div>
                                                            <input type="number" name="max_open_positions" id="max_open_positions" class="form-control" 
                                                                   value="<?php echo isset($settings['risk_management']['max_open_positions']) ? $settings['risk_management']['max_open_positions'] : 5; ?>" min="1" max="20">
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: 3-5</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="max_risk_per_trade">
                                                            İşlem Başına Maksimum Risk
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Toplam sermayenin işlem başına maksimum risk oranı"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-percent"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="max_risk_per_trade" id="max_risk_per_trade" class="form-control" 
                                                                   value="<?php echo isset($settings['risk_management']['max_risk_per_trade']) ? $settings['risk_management']['max_risk_per_trade'] : 2; ?>" min="0.1" max="10">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: %1-2</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                  <!-- Backtesting -->
                                <div class="tab-pane fade" id="backtesting" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Backtesting (Geriye Dönük Test)</h6>
                                            <p class="mb-0">Backtesting, stratejilerinizi geçmiş veriler üzerinde test etmenize olanak sağlar. Bu sayede stratejinizin performansını risk almadan değerlendirebilirsiniz.</p>
                                        </div>
                                    </div>

                                    <div class="alert alert-info">
                                        <i class="fas fa-lightbulb"></i> <strong>İpucu:</strong> Farklı piyasa koşullarında test yapmayı unutmayın. Yükselen, düşen ve yatay piyasalarda stratejinizin nasıl performans gösterdiğini kontrol edin.
                                    </div>

                                    <div class="card mb-3">
                                        <div class="card-header">
                                            <div class="custom-control custom-switch float-right">
                                                <input type="checkbox" class="custom-control-input" id="enable_visualization" name="enable_visualization"
                                                       <?php echo isset($settings['backtesting']['enable_visualization']) && $settings['backtesting']['enable_visualization'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="enable_visualization">Görselleştirme</label>
                                            </div>
                                            <h5 class="mb-0">Backtesting (Geriye Dönük Test)</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="default_start_date">Varsayılan Başlangıç Tarihi</label>
                                                        <input type="date" name="default_start_date" id="default_start_date" class="form-control" 
                                                               value="<?php echo isset($settings['backtesting']['default_start_date']) ? $settings['backtesting']['default_start_date'] : date('Y-m-d', strtotime('-3 months')); ?>">
                                                        <small class="form-text text-muted">Backtesting için varsayılan başlangıç tarihi</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="default_end_date">Varsayılan Bitiş Tarihi</label>
                                                        <input type="date" name="default_end_date" id="default_end_date" class="form-control" 
                                                               value="<?php echo isset($settings['backtesting']['default_end_date']) ? $settings['backtesting']['default_end_date'] : date('Y-m-d'); ?>">
                                                        <small class="form-text text-muted">Backtesting için varsayılan bitiş tarihi</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="initial_capital">Başlangıç Sermayesi</label>
                                                        <div class="input-group">
                                                            <input type="number" step="0.01" name="initial_capital" id="initial_capital" class="form-control" 
                                                                   value="<?php echo isset($settings['backtesting']['initial_capital']) ? $settings['backtesting']['initial_capital'] : 1000; ?>">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text"><?php echo $settings['base_currency']; ?></span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Test başlangıcındaki sanal sermaye miktarı</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="trading_fee">İşlem Ücreti</label>
                                                        <div class="input-group">
                                                            <input type="number" step="0.001" name="trading_fee" id="trading_fee" class="form-control" 
                                                                   value="<?php echo isset($settings['backtesting']['trading_fee']) ? $settings['backtesting']['trading_fee'] : 0.001; ?>" min="0" max="0.01">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Her işlem için alınacak komisyon (0.001 = %0.1)</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="form-group">
                                                        <label for="slippage">Slippage (Kayma)</label>
                                                        <div class="input-group">
                                                            <input type="number" step="0.001" name="slippage" id="slippage" class="form-control" 
                                                                   value="<?php echo isset($settings['backtesting']['slippage']) ? $settings['backtesting']['slippage'] : 0.001; ?>" min="0" max="0.01">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Beklenilen ve gerçekleşen fiyat arasındaki fark (0.001 = %0.1)</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="alert alert-info mt-3">
                                                <i class="fas fa-info-circle"></i> 
                                                <strong>Backtesting Nedir?</strong> Backtesting, bir trading stratejisinin geçmiş verilerde nasıl performans göstereceğini test etmenizi sağlar.
                                                Bu, gerçek para riske atmadan önce stratejilerinizin etkinliğini değerlendirmek için harika bir yöntemdir.
                                            </div>
                                            
                                            <div class="mt-4">
                                                <h5>Backtesting İşlemi Nasıl Yapılır?</h5>
                                                <ol>
                                                    <li>Başlangıç ve bitiş tarihlerini belirleyin</li>
                                                    <li>Test etmek istediğiniz stratejiyi seçin</li>
                                                    <li>Başlangıç sermayesini ayarlayın</li>
                                                    <li>Gerçekçi işlem ücreti ve kayma değerleri girin</li>
                                                    <li>Backtesting sayfasına gidin ve testi başlatın</li>
                                                </ol>
                                                <p>
                                                    <a href="backtesting.php" class="btn btn-primary">
                                                        <i class="fas fa-chart-line"></i> Backtest Çalıştır
                                                    </a>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Akıllı Trend Analizi -->
                                <div class="tab-pane fade" id="smart-trend" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Akıllı Trend Analizi</h6>
                                            <p class="mb-0">Akıllı trend analizi modülü, piyasanın gidişatını daha etkili bir şekilde belirlemek ve yanlış sinyallerden kaçınmak için gelişmiş algoritmalar kullanır.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="feature-card mb-4 <?php echo isset($settings['integration_settings']['use_smart_trend']) && $settings['integration_settings']['use_smart_trend'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-chart-line"></i> Akıllı Trend Analizi</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="use_smart_trend" name="use_smart_trend"
                                                       <?php echo isset($settings['integration_settings']['use_smart_trend']) && $settings['integration_settings']['use_smart_trend'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="use_smart_trend"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <p class="feature-description">
                                                Akıllı trend analizi, fiyat hareketlerini değerlendirirken birden fazla indikatörü, zaman dilimini ve piyasa koşullarını dikkate alır. Böylece yanlış sinyalleri azaltır ve daha doğru giriş/çıkış noktaları belirlemenize yardımcı olur.
                                            </p>
                                            
                                            <div class="row mt-4">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="trend_detection_method">Trend Tespiti Metodu</label>
                                                        <select name="trend_detection_method" id="trend_detection_method" class="form-control">
                                                            <option value="adaptive" <?php echo (isset($settings['integration_settings']['smart_trend_settings']['detection_method']) && $settings['integration_settings']['smart_trend_settings']['detection_method'] == 'adaptive') ? 'selected' : ''; ?>>Adaptif (önerilen)</option>
                                                            <option value="multi_timeframe" <?php echo (isset($settings['integration_settings']['smart_trend_settings']['detection_method']) && $settings['integration_settings']['smart_trend_settings']['detection_method'] == 'multi_timeframe') ? 'selected' : ''; ?>>Çoklu Zaman Dilimi</option>
                                                            <option value="machine_learning" <?php echo (isset($settings['integration_settings']['smart_trend_settings']['detection_method']) && $settings['integration_settings']['smart_trend_settings']['detection_method'] == 'machine_learning') ? 'selected' : ''; ?>>Makine Öğrenmesi</option>
                                                            <option value="statistical" <?php echo (isset($settings['integration_settings']['smart_trend_settings']['detection_method']) && $settings['integration_settings']['smart_trend_settings']['detection_method'] == 'statistical') ? 'selected' : ''; ?>>İstatistiksel Analiz</option>
                                                        </select>
                                                        <small class="form-text text-muted">Trend analizinde kullanılacak algoritma</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="trend_sensitivity">Hassasiyet</label>
                                                        <input type="range" class="custom-range" min="0.1" max="1" step="0.1" id="trend_sensitivity" name="trend_sensitivity" 
                                                               value="<?php echo isset($settings['integration_settings']['smart_trend_settings']['sensitivity']) ? $settings['integration_settings']['smart_trend_settings']['sensitivity'] : '0.5'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">Düşük (0.1)</small>
                                                            <small class="text-primary" id="trend_sensitivity_value"><?php echo isset($settings['integration_settings']['smart_trend_settings']['sensitivity']) ? $settings['integration_settings']['smart_trend_settings']['sensitivity'] : '0.5'; ?></small>
                                                            <small class="text-muted">Yüksek (1)</small>
                                                        </div>
                                                        <small class="form-text text-muted">Trend değişimlerine karşı algoritmanın hassasiyeti</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="trend_lookback_period">Geriye Dönük İnceleme Periyodu</label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-history"></i></span>
                                                            </div>
                                                            <input type="number" name="trend_lookback_period" id="trend_lookback_period" class="form-control" 
                                                                   value="<?php echo isset($settings['integration_settings']['smart_trend_settings']['lookback_period']) ? $settings['integration_settings']['smart_trend_settings']['lookback_period'] : '50'; ?>" min="10" max="200">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">mum</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Trend analizi için geriye dönük incelenecek mum sayısı</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="trend_confirmation_period">Onaylama Periyodu</label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-check-double"></i></span>
                                                            </div>
                                                            <input type="number" name="trend_confirmation_period" id="trend_confirmation_period" class="form-control" 
                                                                   value="<?php echo isset($settings['integration_settings']['smart_trend_settings']['confirmation_period']) ? $settings['integration_settings']['smart_trend_settings']['confirmation_period'] : '3'; ?>" min="1" max="10">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">mum</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Trend değişimini onaylamak için gereken minimum mum sayısı</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="signal_quality_threshold">Sinyal Kalite Eşiği</label>
                                                        <input type="range" class="custom-range" min="0.1" max="1" step="0.05" id="signal_quality_threshold" name="signal_quality_threshold" 
                                                               value="<?php echo isset($settings['integration_settings']['smart_trend_settings']['signal_quality_threshold']) ? $settings['integration_settings']['smart_trend_settings']['signal_quality_threshold'] : '0.7'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">Düşük (0.1)</small>
                                                            <small class="text-primary" id="signal_quality_threshold_value"><?php echo isset($settings['integration_settings']['smart_trend_settings']['signal_quality_threshold']) ? $settings['integration_settings']['smart_trend_settings']['signal_quality_threshold'] : '0.7'; ?></small>
                                                            <small class="text-muted">Yüksek (1)</small>
                                                        </div>
                                                        <small class="form-text text-muted">Sinyalin kabul edilmesi için gereken minimum kalite puanı</small>
                                                    </div>
                                                </div>
                                            </div>
                                                          <div class="alert alert-info mt-3">
                                                <i class="fas fa-info-circle"></i> <strong>İpucu:</strong> Akıllı trend analizi, piyasa koşullarına göre otomatik olarak parametrelerini ayarlayabilir. Daha güvenilir sinyaller için yüksek kalite eşiği belirlemeniz önerilir.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Adaptif Parametreler -->
                                <div class="tab-pane fade" id="adaptive-parameters" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Adaptif Parametreler</h6>
                                            <p class="mb-0">Adaptif parametreler, botun değişen piyasa koşullarına göre kendini otomatik olarak ayarlamasını sağlar. Bu özellik, farklı piyasa durumlarında daha iyi performans sağlayabilir.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="feature-card mb-4 <?php echo isset($settings['adaptive_parameters']['enabled']) && $settings['adaptive_parameters']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-sliders-h"></i> Adaptif Parametreler</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="adaptive_params_enabled" name="adaptive_params_enabled"
                                                       <?php echo isset($settings['adaptive_parameters']['enabled']) && $settings['adaptive_parameters']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="adaptive_params_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="adaptation_speed">Adaptasyon Hızı</label>
                                                        <input type="range" class="custom-range" min="0.1" max="1" step="0.1" id="adaptation_speed" name="adaptation_speed" 
                                                               value="<?php echo isset($settings['adaptive_parameters']['adaptation_speed']) ? $settings['adaptive_parameters']['adaptation_speed'] : '0.5'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">Yavaş (0.1)</small>
                                                            <small class="text-primary" id="adaptation_speed_value"><?php echo isset($settings['adaptive_parameters']['adaptation_speed']) ? $settings['adaptive_parameters']['adaptation_speed'] : '0.5'; ?></small>
                                                            <small class="text-muted">Hızlı (1)</small>
                                                        </div>
                                                        <small class="form-text text-muted">Botun parametreleri ne hızda güncelleyeceğini belirler</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="learning_rate">Öğrenme Oranı</label>
                                                        <input type="range" class="custom-range" min="0.01" max="0.5" step="0.01" id="learning_rate" name="learning_rate" 
                                                               value="<?php echo isset($settings['adaptive_parameters']['learning_rate']) ? $settings['adaptive_parameters']['learning_rate'] : '0.1'; ?>">
                                                        <div class="d-flex justify-content-between">
                                                            <small class="text-muted">Düşük (0.01)</small>
                                                            <small class="text-primary" id="learning_rate_value"><?php echo isset($settings['adaptive_parameters']['learning_rate']) ? $settings['adaptive_parameters']['learning_rate'] : '0.1'; ?></small>
                                                            <small class="text-muted">Yüksek (0.5)</small>
                                                        </div>
                                                        <small class="form-text text-muted">Yeni verilerin model üzerindeki etkisini belirler</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="min_history_required">Minimum Geçmiş Gereksinimi</label>
                                                        <div class="input-group">
                                                            <input type="number" name="min_history_required" id="min_history_required" class="form-control" 
                                                                   value="<?php echo isset($settings['adaptive_parameters']['min_history_required']) ? $settings['adaptive_parameters']['min_history_required'] : '100'; ?>" min="10" max="500">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">mum</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Adaptasyon için gerekli minimum veri miktarı</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Piyasa Rejimi Tespiti</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="market_regime_detection" name="market_regime_detection"
                                                                   <?php echo isset($settings['adaptive_parameters']['market_regime_detection']) && $settings['adaptive_parameters']['market_regime_detection'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="market_regime_detection">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Trend, aralık veya volatilite gibi piyasa durumlarını tespit eder</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Piyasa Değişiminde Sıfırla</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="reset_after_market_shift" name="reset_after_market_shift"
                                                                   <?php echo isset($settings['adaptive_parameters']['reset_after_market_shift']) && $settings['adaptive_parameters']['reset_after_market_shift'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="reset_after_market_shift">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Piyasa durumu değiştiğinde parametreleri sıfırlar</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Volatilite Ayarlaması</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="volatility_adjustment" name="volatility_adjustment"
                                                                   <?php echo isset($settings['adaptive_parameters']['volatility_adjustment']) && $settings['adaptive_parameters']['volatility_adjustment'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="volatility_adjustment">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Piyasa volatilitesine göre parametreleri ayarlar</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Trend Gücü Ayarlaması</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="trend_strength_adjustment" name="trend_strength_adjustment"
                                                                   <?php echo isset($settings['adaptive_parameters']['trend_strength_adjustment']) && $settings['adaptive_parameters']['trend_strength_adjustment'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="trend_strength_adjustment">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Trendin gücüne göre parametreleri ayarlar</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- API Optimizasyonu -->
                                <div class="tab-pane fade" id="api-optimization" role="tabpanel">
                                    <div class="info-box info mb-4">
                                        <i class="fas fa-info-circle"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">API Optimizasyonu</h6>
                                            <p class="mb-0">API optimizasyonu, borsalarla yapılan API iletişimini optimize ederek hem işlem limitlerini korur hem de sistem performansını artırır.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="feature-card mb-4 <?php echo isset($settings['api_optimization']['enabled']) && $settings['api_optimization']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-tachometer-alt"></i> API Optimizasyonu</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="api_optimization_enabled" name="api_optimization_enabled"
                                                       <?php echo isset($settings['api_optimization']['enabled']) && $settings['api_optimization']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="api_optimization_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="api_call_limit_per_minute">API Çağrı Limiti (dakikada)</label>
                                                        <div class="input-group">
                                                            <input type="number" name="api_call_limit_per_minute" id="api_call_limit_per_minute" class="form-control" 
                                                                   value="<?php echo isset($settings['api_optimization']['api_call_limit_per_minute']) ? $settings['api_optimization']['api_call_limit_per_minute'] : '60'; ?>" min="1" max="1200">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">adet/dakika</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Dakika başına maksimum API çağrısı sayısı</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="cache_duration">Önbellek Süresi</label>
                                                        <div class="input-group">
                                                            <input type="number" name="cache_duration" id="cache_duration" class="form-control" 
                                                                   value="<?php echo isset($settings['api_optimization']['cache_duration']) ? $settings['api_optimization']['cache_duration'] : '60'; ?>" min="1" max="3600">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">saniye</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Verilerin önbellekte tutulma süresi</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="api_call_distribution">API Çağrıları Dağıtım Yöntemi</label>
                                                        <select name="api_call_distribution" id="api_call_distribution" class="form-control">
                                                            <option value="even" <?php echo isset($settings['api_optimization']['api_call_distribution']) && $settings['api_optimization']['api_call_distribution'] == 'even' ? 'selected' : ''; ?>>Eşit Dağılım</option>
                                                            <option value="priority" <?php echo isset($settings['api_optimization']['api_call_distribution']) && $settings['api_optimization']['api_call_distribution'] == 'priority' ? 'selected' : ''; ?>>Öncelik Bazlı</option>
                                                            <option value="adaptive" <?php echo isset($settings['api_optimization']['api_call_distribution']) && $settings['api_optimization']['api_call_distribution'] == 'adaptive' ? 'selected' : ''; ?>>Adaptif</option>
                                                        </select>
                                                        <small class="form-text text-muted">API çağrılarının nasıl dağıtılacağını belirler</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Aktif İşlemlere Öncelik Ver</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="prioritize_active_trades" name="prioritize_active_trades"
                                                                   <?php echo isset($settings['api_optimization']['prioritize_active_trades']) && $settings['api_optimization']['prioritize_active_trades'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="prioritize_active_trades">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Açık pozisyonlara sahip coinlere öncelik verir</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Zaman Aralığı Sayısını Azalt</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="reduce_timeframes_count" name="reduce_timeframes_count"
                                                                   <?php echo isset($settings['api_optimization']['reduce_timeframes_count']) && $settings['api_optimization']['reduce_timeframes_count'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="reduce_timeframes_count">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Yüksek yükte gerekli olmayan zaman aralıklarını devre dışı bırakır</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>İndikatör Hesaplamalarını Optimize Et</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="optimize_indicator_calculations" name="optimize_indicator_calculations"
                                                                   <?php echo isset($settings['api_optimization']['optimize_indicator_calculations']) && $settings['api_optimization']['optimize_indicator_calculations'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="optimize_indicator_calculations">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">İndikatör hesaplamalarını optimize ederek performansı artırır</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>                                <!-- Gelişmiş Risk Yönetimi sekmesi -->
                                <div class="tab-pane fade" id="risk-management-advanced" role="tabpanel">
                                    <div class="info-box warning mb-4">
                                        <i class="fas fa-shield-alt"></i>
                                        <div>
                                            <h6 class="font-weight-bold mb-1">Gelişmiş Risk Yönetimi</h6>
                                            <p class="mb-0">Bu modül, standart risk yönetiminin ötesinde, piyasa koşullarına dinamik olarak uyum sağlayan gelişmiş risk yönetimi stratejileri sunar. Yanlış sinyallerden korunmak ve sermayenizi daha etkili şekilde korumak için bu ayarları kullanabilirsiniz.</p>
                                        </div>
                                    </div>
                                    
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle"></i> <strong>İpucu:</strong> Bu ayarları aktif etmeden önce, temel risk yönetimi stratejilerinizi belirlemiş olduğunuzdan emin olun.
                                    </div>
                                    
                                    <div class="feature-card mb-4 <?php echo isset($settings['advanced_risk_management']['enabled']) && $settings['advanced_risk_management']['enabled'] ? 'enabled' : 'disabled'; ?>">
                                        <div class="feature-card-header">
                                            <h5><i class="fas fa-shield-alt"></i> Gelişmiş Risk Yönetimi</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="advanced_risk_enabled" name="advanced_risk_enabled"
                                                       <?php echo isset($settings['advanced_risk_management']['enabled']) && $settings['advanced_risk_management']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="advanced_risk_enabled"></label>
                                            </div>
                                        </div>
                                        <div class="feature-card-body">
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="dynamic_position_sizing">
                                                            Dinamik Pozisyon Boyutlandırma
                                                        </label>
                                                        <div class="custom-control custom-switch mt-2">
                                                            <input type="checkbox" class="custom-control-input" id="dynamic_position_sizing" name="dynamic_position_sizing"
                                                                   <?php echo isset($settings['advanced_risk_management']['dynamic_position_sizing']) && $settings['advanced_risk_management']['dynamic_position_sizing'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="dynamic_position_sizing">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Piyasa koşullarına ve sinyal gücüne göre pozisyon boyutunu otomatik ayarlar</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="position_size_method">Pozisyon Boyutu Metodu</label>
                                                        <select name="position_size_method" id="position_size_method" class="form-control" 
                                                               <?php echo isset($settings['advanced_risk_management']['dynamic_position_sizing']) && $settings['advanced_risk_management']['dynamic_position_sizing'] ? '' : 'disabled'; ?>>
                                                            <option value="fixed" <?php echo (isset($settings['advanced_risk_management']['position_size_method']) && $settings['advanced_risk_management']['position_size_method'] == 'fixed') ? 'selected' : ''; ?>>Sabit Yüzde</option>
                                                            <option value="kelly" <?php echo (isset($settings['advanced_risk_management']['position_size_method']) && $settings['advanced_risk_management']['position_size_method'] == 'kelly') ? 'selected' : ''; ?>>Kelly Kriteri</option>
                                                            <option value="signal_quality" <?php echo (isset($settings['advanced_risk_management']['position_size_method']) && $settings['advanced_risk_management']['position_size_method'] == 'signal_quality') ? 'selected' : ''; ?>>Sinyal Kalitesine Göre</option>
                                                            <option value="volatility" <?php echo (isset($settings['advanced_risk_management']['position_size_method']) && $settings['advanced_risk_management']['position_size_method'] == 'volatility') ? 'selected' : ''; ?>>Volatiliteye Göre</option>
                                                        </select>
                                                        <small class="form-text text-muted">Pozisyon büyüklüğünü belirlerken kullanılacak yöntem</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="volatility_based_stops">
                                                            Volatilite Bazlı Stop-Loss
                                                        </label>
                                                        <div class="custom-control custom-switch mt-2">
                                                            <input type="checkbox" class="custom-control-input" id="volatility_based_stops" name="volatility_based_stops"
                                                                   <?php echo isset($settings['advanced_risk_management']['volatility_based_stops']) && $settings['advanced_risk_management']['volatility_based_stops'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="volatility_based_stops">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Stop-loss seviyesini piyasa volatilitesine göre otomatik ayarlar (ATR bazlı)</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="adaptive_take_profit">
                                                            Adaptif Take-Profit
                                                        </label>
                                                        <div class="custom-control custom-switch mt-2">
                                                            <input type="checkbox" class="custom-control-input" id="adaptive_take_profit" name="adaptive_take_profit"
                                                                   <?php echo isset($settings['advanced_risk_management']['adaptive_take_profit']) && $settings['advanced_risk_management']['adaptive_take_profit'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="adaptive_take_profit">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Take-profit seviyesini piyasa koşullarına göre otomatik ayarlar</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="max_risk_per_trade">
                                                            İşlem Başına Maksimum Risk
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Toplam sermayenin işlem başına maksimum risk oranı"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-percent"></i></span>
                                                            </div>
                                                            <input type="number" step="0.01" name="max_risk_per_trade" id="max_risk_per_trade" class="form-control" 
                                                                   value="<?php echo isset($settings['advanced_risk_management']['max_risk_per_trade']) ? $settings['advanced_risk_management']['max_risk_per_trade'] : '1'; ?>" min="0.1" max="5">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">%</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: %0.5-1 (her işlem için maksimum kayıp)</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="max_open_positions">
                                                            Maksimum Açık Pozisyon
                                                            <i class="far fa-question-circle tooltip-icon" data-toggle="tooltip" title="Aynı anda açık tutulabilecek maksimum pozisyon sayısı"></i>
                                                        </label>
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="fas fa-layer-group"></i></span>
                                                            </div>
                                                            <input type="number" name="max_open_positions" id="max_open_positions" class="form-control" 
                                                                   value="<?php echo isset($settings['advanced_risk_management']['max_open_positions']) ? $settings['advanced_risk_management']['max_open_positions'] : '3'; ?>" min="1" max="20">
                                                            <div class="input-group-append">
                                                                <span class="input-group-text">adet</span>
                                                            </div>
                                                        </div>
                                                        <small class="form-text text-muted">Önerilen: 3-5 pozisyon</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row mt-3">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="auto_adjust_risk">
                                                            Otomatik Risk Ayarlama
                                                        </label>
                                                        <div class="custom-control custom-switch mt-2">
                                                            <input type="checkbox" class="custom-control-input" id="auto_adjust_risk" name="auto_adjust_risk"
                                                                   <?php echo isset($settings['advanced_risk_management']['auto_adjust_risk']) && $settings['advanced_risk_management']['auto_adjust_risk'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="auto_adjust_risk">Aktif</label>
                                                        </div>
                                                        <small class="form-text text-muted">Performansa göre risk seviyesini otomatik olarak ayarlar</small>
                                                    </div>
                                                </div>
                                            </div>
                                              <div class="alert alert-info mt-3">
                                                <i class="fas fa-info-circle"></i> <strong>İpucu:</strong> Gelişmiş risk yönetimi ayarlarını dikkatli kullanın. Özellikle volatil piyasalarda, aşırı korumacı ayarlar fırsatları kaçırmanıza neden olabilir.
                                            </div>
                                        </div>
                                    </div>                                
                                </div><!-- End of risk-management-advanced -->
                               
                                
                                <!-- API Ayarları -->
                                <div class="tab-pane fade" id="api" role="tabpanel">
                                    <div class="alert alert-warning">
                                        <i class="fas fa-exclamation-triangle"></i> Bu bölümdeki değişiklikler doğrudan yapılandırma dosyalarında güncellenir. Dikkatli olun!
                                    </div>
                                    
                                    <h5 class="mb-3">Borsa API Ayarları</h5>
                                    
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0">Binance</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label for="binance_api_key">API Key</label>
                                                <input type="text" name="binance_api_key" id="binance_api_key" class="form-control" 
                                                       placeholder="Binance API Key" value="<?php echo isset($settings['api_keys']['binance_api_key']) ? $settings['api_keys']['binance_api_key'] : ''; ?>">
                                            </div>
                                            <div class="form-group">
                                                <label for="binance_api_secret">API Secret</label>
                                                <input type="password" name="binance_api_secret" id="binance_api_secret" class="form-control" 
                                                       placeholder="Binance API Secret" value="<?php echo isset($settings['api_keys']['binance_api_secret']) ? $settings['api_keys']['binance_api_secret'] : ''; ?>">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="card mb-4">
                                        <div class="card-header">
                                            <h5 class="mb-0">KuCoin</h5>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label for="kucoin_api_key">API Key</label>
                                                <input type="text" name="kucoin_api_key" id="kucoin_api_key" class="form-control" 
                                                       placeholder="KuCoin API Key" value="<?php echo isset($settings['api_keys']['kucoin_api_key']) ? $settings['api_keys']['kucoin_api_key'] : ''; ?>">
                                            </div>
                                            <div class="form-group">
                                                <label for="kucoin_api_secret">API Secret</label>
                                                <input type="password" name="kucoin_api_secret" id="kucoin_api_secret" class="form-control" 
                                                       placeholder="KuCoin API Secret" value="<?php echo isset($settings['api_keys']['kucoin_api_secret']) ? $settings['api_keys']['kucoin_api_secret'] : ''; ?>">
                                            </div>
                                            <div class="form-group">
                                                <label for="kucoin_api_passphrase">API Passphrase</label>
                                                <input type="password" name="kucoin_api_passphrase" id="kucoin_api_passphrase" class="form-control" 
                                                       placeholder="KuCoin API Passphrase" value="<?php echo isset($settings['api_keys']['kucoin_api_passphrase']) ? $settings['api_keys']['kucoin_api_passphrase'] : ''; ?>">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <h5 class="mb-3">Telegram Ayarları</h5>
                                    
                                    <div class="card mb-4">
                                        <div class="card-header d-flex justify-content-between align-items-center">
                                            <h5 class="mb-0">Telegram Bot</h5>
                                            <div class="custom-control custom-switch">
                                                <input type="checkbox" class="custom-control-input" id="telegram_enabled" name="telegram_enabled"
                                                       <?php echo isset($settings['telegram']['enabled']) && $settings['telegram']['enabled'] ? 'checked' : ''; ?>>
                                                <label class="custom-control-label" for="telegram_enabled">Etkinleştir</label>
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <div class="form-group">
                                                <label for="telegram_token">Bot Token</label>
                                                <input type="text" name="telegram_token" id="telegram_token" class="form-control" 
                                                       value="<?php echo isset($settings['telegram']['token']) ? $settings['telegram']['token'] : ''; ?>" placeholder="Telegram Bot Token">
                                                <small class="form-text text-muted">BotFather üzerinden oluşturduğunuz botun token değeri</small>
                                            </div>
                                            <div class="form-group">
                                                <label for="telegram_chat_id">Chat ID</label>
                                                <input type="text" name="telegram_chat_id" id="telegram_chat_id" class="form-control" 
                                                       value="<?php echo isset($settings['telegram']['chat_id']) ? $settings['telegram']['chat_id'] : ''; ?>" placeholder="Telegram Chat ID">
                                                <small class="form-text text-muted">Bildirimlerin gönderileceği chat ID (kişi veya grup)</small>
                                            </div>
                                            
                                            <h6 class="mt-4 mb-3">Bildirim Ayarları</h6>
                                            
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Trade Sinyalleri</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="telegram_trade_signals" name="telegram_trade_signals"
                                                                   <?php echo isset($settings['telegram']['trade_signals']) && $settings['telegram']['trade_signals'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="telegram_trade_signals">Gönder</label>
                                                        </div>
                                                        <small class="form-text text-muted">Alım-satım sinyallerini Telegram'da bildir</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Pozisyon Güncellemeleri</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="telegram_position_updates" name="telegram_position_updates"
                                                                   <?php echo isset($settings['telegram']['position_updates']) && $settings['telegram']['position_updates'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="telegram_position_updates">Gönder</label>
                                                        </div>
                                                        <small class="form-text text-muted">Pozisyon açılış/kapanış bilgilerini bildir</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Performans Raporları</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="telegram_performance_updates" name="telegram_performance_updates"
                                                                   <?php echo isset($settings['telegram']['performance_updates']) && $settings['telegram']['performance_updates'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="telegram_performance_updates">Gönder</label>
                                                        </div>
                                                        <small class="form-text text-muted">Günlük/haftalık performans raporlarını bildir</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label>Keşfedilen Coinler</label>
                                                        <div class="custom-control custom-switch">
                                                            <input type="checkbox" class="custom-control-input" id="telegram_discovered_coins" name="telegram_discovered_coins"
                                                                   <?php echo isset($settings['telegram']['discovered_coins']) && $settings['telegram']['discovered_coins'] ? 'checked' : ''; ?>>
                                                            <label class="custom-control-label" for="telegram_discovered_coins">Gönder</label>
                                                        </div>
                                                        <small class="form-text text-muted">Otomatik keşfedilen yeni coinleri bildir</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="settings-footer">
                                <button type="submit" class="btn btn-save">
                                    <i class="fas fa-save"></i> Ayarları Kaydet
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log("DOM yüklendi, tab sistemi başlatılıyor...");
            
            // Tüm tab linklerini seç
            var tabLinks = document.querySelectorAll('#settingsTabs a[data-toggle="tab"]');
            
            // Her tab linkine tıklama olayı ekle
            tabLinks.forEach(function(tabLink) {
                tabLink.addEventListener('click', function(event) {
                    event.preventDefault();
                    console.log("Tab tıklandı: ", this.getAttribute('href'));
                    
                    // Aktif tab sınıfını tüm linklerden kaldır
                    tabLinks.forEach(function(link) {
                        link.classList.remove('active');
                        link.setAttribute('aria-selected', 'false');
                    });
                    
                    // Tıklanan tab linkini aktif yap
                    this.classList.add('active');
                    this.setAttribute('aria-selected', 'true');
                    
                    // Tüm tab içeriklerini gizle
                    var tabPanes = document.querySelectorAll('.tab-pane');
                    tabPanes.forEach(function(pane) {
                        pane.classList.remove('show', 'active');
                    });
                    
                    // İlgili tab içeriğini göster
                    var target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.classList.add('show', 'active');
                        // Tab seçimini local storage'a kaydet
                        localStorage.setItem('activeSettingsTab', this.getAttribute('href'));
                    } else {
                        console.error("Hedef tab içeriği bulunamadı:", this.getAttribute('href'));
                    }
                });
            });
            
            // Sayfa yüklendiğinde son aktif sekmeyi göster veya ilk sekmeyi aç
            var activeTab = localStorage.getItem('activeSettingsTab');
            if (activeTab) {
                var savedTabLink = document.querySelector('#settingsTabs a[href="' + activeTab + '"]');
                if (savedTabLink) {
                    savedTabLink.click();
                } else {
                    document.querySelector('#settingsTabs a:first-child').click();
                }
            } else {
                document.querySelector('#settingsTabs a:first-child').click();
            }
            
            // Form elemanlarının davranışlarını ayarla
            initFormBehaviors();
            
            console.log("Tab sistemi başlatıldı.");
        });

        function initFormBehaviors() {
            // İndikatörlerin etkinliğine göre kart stilini güncelle
            var checkboxInputs = document.querySelectorAll('.custom-control-input');
            checkboxInputs.forEach(function(checkbox) {
                checkbox.addEventListener('change', function() {
                    var card = this.closest('.feature-card');
                    if (card) {
                        if (this.checked) {
                            card.classList.add('enabled');
                            card.classList.remove('disabled');
                        } else {
                            card.classList.add('disabled');
                            card.classList.remove('enabled');
                        }
                    }
                    
                    // Özel işlevleri çağır
                    var inputId = this.id;
                    switch (inputId) {
                        case 'use_smart_trend':
                            updateSmartTrendUI();
                            break;
                        case 'advanced_risk_enabled':
                            updateAdvancedRiskUI();
                            break;
                        case 'dynamic_position_sizing':
                            updateDynamicPositionSizingUI();
                            break;
                        case 'adaptive_params_enabled':
                            updateAdaptiveParamsUI();
                            break;
                        case 'api_optimization_enabled':
                            updateApiOptimizationUI();
                            break;
                    }
                });
            });
            
            // Form gönderildiğinde yükleniyor göstergesi
            var forms = document.querySelectorAll('form');
            forms.forEach(function(form) {
                form.addEventListener('submit', function() {
                    var submitButton = this.querySelector('button[type="submit"]');
                    if (submitButton) {
                        submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Kaydediliyor...';
                        submitButton.disabled = true;
                    }
                    return true;
                });
            });
        }

        // Yardımcı fonksiyonlar
        function updateSmartTrendUI() {
            var enabled = document.getElementById('use_smart_trend').checked;
            var smartTrendSettings = document.querySelectorAll('.smart-trend-setting');
            smartTrendSettings.forEach(function(element) {
                element.disabled = !enabled;
            });
        }

        function updateAdvancedRiskUI() {
            var enabled = document.getElementById('advanced_risk_enabled').checked;
            var advancedRiskSettings = document.querySelectorAll('.advanced-risk-setting');
            advancedRiskSettings.forEach(function(element) {
                element.disabled = !enabled;
            });
        }

        function updateDynamicPositionSizingUI() {
            var enabled = document.getElementById('dynamic_position_sizing').checked;
            var dynamicPositionSettings = document.querySelectorAll('.dynamic-position-setting');
            dynamicPositionSettings.forEach(function(element) {
                element.disabled = !enabled;
            });
        }

        function updateAdaptiveParamsUI() {
            var enabled = document.getElementById('adaptive_params_enabled').checked;
            var adaptiveParamSettings = document.querySelectorAll('.adaptive-param-setting');
            adaptiveParamSettings.forEach(function(element) {
                element.disabled = !enabled;
            });
        }

        function updateApiOptimizationUI() {
            var enabled = document.getElementById('api_optimization_enabled').checked;
            var apiOptimizationSettings = document.querySelectorAll('.api-optimization-setting');
            apiOptimizationSettings.forEach(function(element) {
                element.disabled = !enabled;
            });
        }

        // jQuery fonksiyonları için fallback - Eğer jQuery yüklenmezse
        if (typeof jQuery === 'undefined') {
            console.warn("jQuery yüklenmedi! Temel tab işlevselliği için kendi fonksiyonlarımızı kullanıyoruz.");
        }
    </script>
</body>
</html>